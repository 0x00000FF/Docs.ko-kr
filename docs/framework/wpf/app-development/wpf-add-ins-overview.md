---
title: "WPF 추가 기능 개요"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
caps.latest.revision: "36"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 76a836e2699617803b78f76f90b27452bd0cdd0f
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/22/2017
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="ea0ed-102">WPF 추가 기능 개요</span><span class="sxs-lookup"><span data-stu-id="ea0ed-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="ea0ed-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]에는 개발자가 추가 기능 확장성을 지원하는 응용 프로그램을 만드는 데 사용할 수 있는 추가 기능 모델이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="ea0ed-104">이 추가 기능 모델을 사용하면 응용 프로그램 기능과 통합하고 이 기능을 확장하는 추가 기능을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="ea0ed-105">일부 시나리오에서는 응용 프로그램에서 추가 기능을 통해 제공되는 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]도 표시해야 합니다. 이 항목에서는 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]가 이러한 시나리오를 가능하게 하는 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델을 보강하는 방법, 그 기반이 되는 아키텍처, 해당 이점 및 한계를 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="ea0ed-106">필수 구성 요소</span><span class="sxs-lookup"><span data-stu-id="ea0ed-106">Prerequisites</span></span>  
 <span data-ttu-id="ea0ed-107">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델에 대해 잘 알고 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="ea0ed-108">자세한 내용은 [추가 기능 및 확장성](../../../../docs/framework/add-ins/index.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="ea0ed-109">추가 기능 개요</span><span class="sxs-lookup"><span data-stu-id="ea0ed-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="ea0ed-110">응용 프로그램에서는 새 기능을 통합하기 위해 응용 프로그램을 다시 컴파일하여 배포하는 복잡한 작업을 방지하도록 확장성 메커니즘을 구현하여 개발자(자사 및 타사)가 새 기능을 통합하는 다른 응용 프로그램을 만들 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="ea0ed-111">이러한 형식의 확장성을 지원하는 가장 일반적인 방법은 추가 기능(“추가 기능” 및 “플러그 인”이라고도 함)을 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="ea0ed-112">추가 기능으로 확장성을 노출하는 실제 응용 프로그램의 예에는 다음이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="ea0ed-113">Internet Explorer 추가 기능.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="ea0ed-114">Windows Media Player 플러그 인.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="ea0ed-115">Visual Studio 추가 기능.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="ea0ed-116">예를 들어, Windows Media Player 추가 기능 모델을 사용하면 타사 개발자가 다양한 방식으로 Windows Media Player를 확장하는 “플러그 인”을 구현할 수 있습니다. 이러한 방식에는 Windows Media Player에서 기본적으로 지원하지 않는 미디어 형식(예: DVD, MP3)의 디코더와 인코더, 오디오 효과 및 스킨이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="ea0ed-117">모든 추가 기능 모델에 공통인 동작과 엔터티가 여러 개 있지만, 각 추가 기능 모델은 응용 프로그램에 고유한 기능을 노출하도록 빌드되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="ea0ed-118">일반적인 추가 기능 확장성 솔루션의 세 가지 기본 엔터티는 *계약*, *추가 기능* 및 *호스트 응용 프로그램*입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="ea0ed-119">계약은 추가 기능이 다음 두 방법으로 호스트 응용 프로그램과 통합하는 방법을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="ea0ed-120">추가 기능은 호스트 응용 프로그램으로 구현된 기능과 통합됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="ea0ed-121">호스트 응용 프로그램에서 추가 기능과 통합될 기능을 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="ea0ed-122">추가 기능을 사용하려면 호스트 응용 프로그램에서 해당 기능을 찾아 런타임 시 로드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="ea0ed-123">따라서 추가 기능을 지원하는 응용 프로그램에서는 다음과 같은 추가 작업을 담당합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="ea0ed-124">**검색**: 호스트 응용 프로그램에서 지원하는 계약을 준수하는 추가 기능 찾기.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="ea0ed-125">**활성화**: 추가 기능과의 통신을 로드, 실행 및 설정.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="ea0ed-126">**격리**: 응용 프로그램 도메인 또는 프로세스를 사용하여 추가 기능의 잠재적인 보안 및 실행 문제로부터 응용 프로그램을 보호하는 격리 경계 설정.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="ea0ed-127">**통신**: 추가 기능과 호스트 응용 프로그램을 통해 메서드를 호출하고 데이터를 전달하여 격리 경계를 넘어 서로 통신할 수 있도록 허용.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="ea0ed-128">**수명 관리**: 예측 가능하고 정리된 방식으로 응용 프로그램 도메인과 프로세스를 로드 및 언로드( [응용 프로그램 도메인](../../../../docs/framework/app-domains/application-domains.md) 참조).</span><span class="sxs-lookup"><span data-stu-id="ea0ed-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="ea0ed-129">**버전 관리**: 호스트 응용 프로그램과 추가 기능 중 하나의 새 버전이 만들어진 경우에도 계속 통신 가능한지 확인.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="ea0ed-130">근본적으로, 강력한 추가 기능 모델을 개발하는 것은 쉬운 작업이 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="ea0ed-131">따라서 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]에서는 추가 기능 모델을 빌드하는 인프라를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ea0ed-132">추가 기능에 대한 자세한 내용은 [추가 기능 및 확장성](../../../../docs/framework/add-ins/index.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="ea0ed-133">.NET Framework 추가 기능 모델 개요</span><span class="sxs-lookup"><span data-stu-id="ea0ed-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="ea0ed-134">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델에는 <xref:System.AddIn> 네임 스페이스를 추가 기능에서 확장성의 배포를 단순화 하도록 설계 된 형식 집합을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="ea0ed-135">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델의 기본 단위는 호스트 응용 프로그램과 추가 기능이 서로 통신하는 방법을 정의하는 *계약*입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="ea0ed-136">계약은 계약의 호스트-응용 프로그램별 *보기*를 사용하여 호스트 응용 프로그램에 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="ea0ed-137">마찬가지로 계약의 추가 기능별 *보기*가 추가 기능에 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="ea0ed-138">호스트 응용 프로그램과 추가 기능이 계약의 각 보기 간에 통신할 수 있도록 *어댑터*가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="ea0ed-139">계약, 보기 및 어댑터를 세그먼트라고 하며, 관련 세그먼트 집합이 *파이프라인*을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="ea0ed-140">파이프라인은 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델이 검색, 활성화, 보안 격리, 실행 격리(응용 프로그램 도메인과 프로세스를 모두 사용), 통신, 수명 관리 및 버전 관리를 지원하는 기반입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="ea0ed-141">개발자는 이러한 지원을 모두 활용하여 호스트 응용 프로그램의 기능과 통합하는 추가 기능을 빌드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="ea0ed-142">그러나 일부 시나리오에서는 호스트 응용 프로그램이 추가 기능에서 제공하는 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]를 표시해야 합니다. [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]의 각 프레젠테이션 기술에는 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]를 구현하는 고유 모델이 있으므로 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델에서는 어떠한 특정 프레젠테이션 기술도 지원하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="ea0ed-143">대신 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]는 추가 기능에 대한 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 지원을 사용하여 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델을 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="ea0ed-144">WPF 추가 기능</span><span class="sxs-lookup"><span data-stu-id="ea0ed-144">WPF Add-Ins</span></span>  
 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]<span data-ttu-id="ea0ed-145"> 추가 기능 모델과 함께 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]를 사용하면 호스트 응용 프로그램이 추가 기능의 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]를 표시해야 하는 다양한 시나리오를 처리할 수 있습니다. 특히 다음 두 프로그래밍 모델을 사용하면 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]로 이러한 시나리오를 처리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="ea0ed-146">**추가 기능이 UI를 반환함**.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="ea0ed-147">추가 기능에서 계약에 정의된 대로 메서드 호출을 통해 호스트 응용 프로그램에 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="ea0ed-148">이 시나리오는 다음과 같은 경우에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="ea0ed-149">추가 기능에서 반환하는 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]의 모양은 동적으로 생성되는 보고서와 같이 런타임 시에만 존재하는 조건 또는 데이터에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="ea0ed-150">추가 기능에서 제공하는 서비스의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]는 추가 기능을 사용할 수 있는 호스트 응용 프로그램의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]와 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="ea0ed-151">추가 기능은 주로 호스트 응용 프로그램의 서비스를 수행하며, [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 사용하여 호스트 응용 프로그램에 상태를 보고합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="ea0ed-152">**추가 기능이 UI임**.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-152">**The add-in is a UI**.</span></span> <span data-ttu-id="ea0ed-153">추가 기능은 계약에 정의된 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="ea0ed-154">이 시나리오는 다음과 같은 경우에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="ea0ed-155">추가 기능에서 광고와 같이 표시되고 있지 않은 서비스를 제공하지 않는 경우.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="ea0ed-156">추가 기능에서 제공하는 서비스의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]가 계산기 또는 색 선택과 같은 추가 기능을 사용할 수 있는 모든 호스트 응용 프로그램에 공통적으로 나타나는 경우.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="ea0ed-157">이러한 시나리오에서는 호스트 응용 프로그램과 추가 기능 응용 프로그램 도메인 간에 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 개체를 전달할 수 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="ea0ed-158">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델은 원격을 이용하여 응용 프로그램 도메인 간에 통신하므로, 두 도메인 간에 전달되는 개체는 원격으로 사용 가능해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="ea0ed-159">원격으로 사용 가능한 개체는 다음 중 하나 이상을 수행하는 클래스의 인스턴스입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="ea0ed-160">파생 되는 <xref:System.MarshalByRefObject> 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="ea0ed-161"><xref:System.Runtime.Serialization.ISerializable> 인터페이스를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="ea0ed-162">에 <xref:System.SerializableAttribute> 특성이 적용 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ea0ed-163">원격으로 사용 가능한 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 개체 만들기에 대한 자세한 내용은 [개체를 원격으로 사용 가능하도록 설정](http://msdn.microsoft.com/en-us/01197253-3f13-43b7-894d-9683e431192a)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](http://msdn.microsoft.com/en-us/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="ea0ed-164">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 형식은 원격으로 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="ea0ed-165">문제점을 해결하기 위해 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]에서는 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델을 확장하여 추가 기능을 통해 만들어진 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 호스트 응용 프로그램에서 표시할 수 있게 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="ea0ed-166">이 지원은가 제공 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 두 유형을 통해:는 <xref:System.AddIn.Contract.INativeHandleContract> 인터페이스 및 두 개의 정적 메서드를 구현한는 <xref:System.AddIn.Pipeline.FrameworkElementAdapters> 클래스: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> 및 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="ea0ed-167">상위 수준에서는 대략적으로 이러한 형식과 메서드가 다음과 같은 방식으로 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="ea0ed-168">사용 하려면 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] 제공한 추가 기능에서 직접 또는 간접적으로 파생 된 클래스는 <xref:System.Windows.FrameworkElement>, 셰이프, 컨트롤, 사용자 정의 컨트롤, 레이아웃 패널 및 페이지 등.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="ea0ed-169">UI를 추가 하 고 호스트 응용 프로그램 간에 전달 되는 선언 하는 계약, 때마다로 선언 되어야 합니다는 <xref:System.AddIn.Contract.INativeHandleContract> (하지는 <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> 추가 기능에 대 한 원격 가능 표현인 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 격리 경계를 넘어 전달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="ea0ed-170">응용 프로그램 도메인에 대 한 추가 기능에서 전달 되기 전에 <xref:System.Windows.FrameworkElement> 로 패키지 한 <xref:System.AddIn.Contract.INativeHandleContract> 호출 하 여 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="ea0ed-171">호스트 응용 프로그램의 응용 프로그램 도메인에 전달 된 후의 <xref:System.AddIn.Contract.INativeHandleContract> 로 다시 패키지는 <xref:System.Windows.FrameworkElement> 호출 하 여 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="ea0ed-172">어떻게 <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, 및 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> 사용 되는 특정 시나리오에 따라 달라 집니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="ea0ed-173">다음 섹션에서는 각 프로그래밍 모델의 자세한 내용을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="ea0ed-174">추가 기능이 사용자 인터페이스를 반환함</span><span class="sxs-lookup"><span data-stu-id="ea0ed-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="ea0ed-175">추가 기능이 호스트 응용 프로그램에 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 반환하려면 다음이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="ea0ed-176">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [추가 기능 및 확장성](../../../../docs/framework/add-ins/index.md) 문서에 설명된 대로 호스트 응용 프로그램, 추가 기능 및 파이프라인을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="ea0ed-177">계약을 구현 해야 <xref:System.AddIn.Contract.IContract> 고 반환 하는 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], 계약 형식의 반환 값을 사용 하 여 메서드를 선언 해야 <xref:System.AddIn.Contract.INativeHandleContract>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="ea0ed-178">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 전달 되는 추가 기능과 호스트 간의 응용 프로그램 직접 또는 간접적으로에서 파생 되어야 <xref:System.Windows.FrameworkElement>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="ea0ed-179">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 에서 반환 하는 추가 기능에서 변환 해야는 <xref:System.Windows.FrameworkElement> 에 <xref:System.AddIn.Contract.INativeHandleContract> 격리 경계를 통과 하기 전에.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="ea0ed-180">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 에서 변환 해야 반환 되는 프로그램 <xref:System.AddIn.Contract.INativeHandleContract> 에 <xref:System.Windows.FrameworkElement> 격리 경계를 통과 한 후 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="ea0ed-181">호스트 응용 프로그램은 반환 된 표시 <xref:System.Windows.FrameworkElement>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="ea0ed-182">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 반환하는 추가 기능을 구현하는 방법을 설명하는 예는 [UI를 반환하는 추가 기능 만들기](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="ea0ed-183">추가 기능이 사용자 인터페이스임</span><span class="sxs-lookup"><span data-stu-id="ea0ed-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="ea0ed-184">추가 기능이 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]이면 다음이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="ea0ed-185">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [추가 기능 및 확장성](../../../../docs/framework/add-ins/index.md) 문서에 설명된 대로 호스트 응용 프로그램, 추가 기능 및 파이프라인을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="ea0ed-186">추가 기능에 대 한 계약 인터페이스를 구현 해야 <xref:System.AddIn.Contract.INativeHandleContract>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="ea0ed-187">호스트 응용 프로그램에 전달 되는 추가 기능에 직접 또는 간접적으로에서 파생 되어야 <xref:System.Windows.FrameworkElement>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="ea0ed-188">추가 기능에서 변환 해야는 <xref:System.Windows.FrameworkElement> 에 <xref:System.AddIn.Contract.INativeHandleContract> 격리 경계를 통과 하기 전에.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="ea0ed-189">추가 기능에서 변환 해야는 <xref:System.AddIn.Contract.INativeHandleContract> 에 <xref:System.Windows.FrameworkElement> 격리 경계를 통과 한 후 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="ea0ed-190">호스트 응용 프로그램은 반환 된 표시 <xref:System.Windows.FrameworkElement>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="ea0ed-191">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]인 추가 기능을 구현하는 방법을 설명하는 예는 [UI인 추가 기능 만들기](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="ea0ed-192">추가 기능에서 여러 UI 반환</span><span class="sxs-lookup"><span data-stu-id="ea0ed-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="ea0ed-193">추가 기능에서 표시할 호스트 응용 프로그램을 위해 여러 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]를 제공하는 경우가 많습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="ea0ed-194">예를 들어, [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]인 추가 기능이 호스트 응용 프로그램에 상태 정보도 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]로 제공하는 경우가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="ea0ed-195">이와 같은 추가 기능은 [추가 기능이 사용자 인터페이스를 반환함](#ReturnUIFromAddInContract) 및 [추가 기능이 사용자 인터페이스임](#AddInIsAUI) 모델의 기술을 조합하여 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="ea0ed-196">추가 기능 및 XAML 브라우저 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="ea0ed-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="ea0ed-197">지금까지의 예에서는 호스트 응용 프로그램이 독립형 응용 프로그램으로 설치되었습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="ea0ed-198">다음과 같은 추가 빌드 및 구현 요구 사항이 있긴 하지만 [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]에서도 추가 기능을 호스팅할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="ea0ed-199">클라이언트 컴퓨터에서 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]와 동일한 폴더의 [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] 응용 프로그램 캐시에 파이프라인(폴더 및 어셈블리) 및 추가 기능 어셈블리를 다운로드하도록 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 응용 프로그램 매니페스트를 특별히 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="ea0ed-200">추가 기능을 검색하고 로드하는 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 코드가 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]의 [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 응용 프로그램 캐시를 파이프라인과 추가 기능 위치로 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="ea0ed-201">추가 기능이 원본 사이트에 있는 느슨한 파일을 참조하는 경우 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]는 특수 보안 컨텍스트에 추가 기능을 로드해야 합니다. 추가 기능이 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]에서 호스팅된 경우 이러한 추가 기능은 호스트 응용 프로그램의 원본 사이트에 있는 느슨한 파일만 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="ea0ed-202">이러한 작업은 다음 하위 섹션에 자세히 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="ea0ed-203">ClickOnce 배포를 위한 파이프라인 및 추가 기능 구성</span><span class="sxs-lookup"><span data-stu-id="ea0ed-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="ea0ed-204">는 [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 배포 캐시의 안전한 폴더로 다운로드되고 이 폴더에서 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="ea0ed-205">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]가 추가 기능을 호스트하려면 파이프라인과 추가 기능 어셈블리도 안전한 폴더에 다운로드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="ea0ed-206">이 작업을 수행하려면 다운로드할 파이프라인과 추가 기능 어셈블리를 모두 포함하도록 응용 프로그램 매니페스트를 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="ea0ed-207">[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]에서 파이프라인 어셈블리를 검색하려면 파이프라인과 추가 기능 어셈블리가 호스트 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 프로젝트의 루트 폴더에 있어야 하지만, 이 작업은 [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]에서 가장 쉽게 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="ea0ed-208">결과적으로 첫 번째 단계에서는 각 파이프라인 어셈블리의 빌드 출력과 추가 기능 어셈블리 프로젝트를 설정하여 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 프로젝트의 루트에 파이프라인 및 추가 기능 어셈블리를 빌드합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="ea0ed-209">다음 표에서는 호스트 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 프로젝트와 동일한 솔루션 및 루트 폴더에 있는 파이프라인 어셈블리 프로젝트와 추가 기능 어셈블리 프로젝트의 빌드 출력 경로를 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="ea0ed-210">표 1: XBAP로 호스팅되는 파이프라인 어셈블리의 출력 경로 빌드</span><span class="sxs-lookup"><span data-stu-id="ea0ed-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="ea0ed-211">파이프라인 어셈블리 프로젝트</span><span class="sxs-lookup"><span data-stu-id="ea0ed-211">Pipeline assembly project</span></span>|<span data-ttu-id="ea0ed-212">빌드 출력 경로</span><span class="sxs-lookup"><span data-stu-id="ea0ed-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="ea0ed-213">계약</span><span class="sxs-lookup"><span data-stu-id="ea0ed-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="ea0ed-214">추가 기능 뷰</span><span class="sxs-lookup"><span data-stu-id="ea0ed-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="ea0ed-215">추가 기능측 어댑터</span><span class="sxs-lookup"><span data-stu-id="ea0ed-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="ea0ed-216">호스트측 어댑터</span><span class="sxs-lookup"><span data-stu-id="ea0ed-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="ea0ed-217">추가 기능</span><span class="sxs-lookup"><span data-stu-id="ea0ed-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="ea0ed-218">다음 단계에서는 다음을 수행하여 파이프라인 어셈블리와 추가 기능 어셈블리를 [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]의 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] 콘텐츠 파일로 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="ea0ed-219">솔루션 탐색기에서 각 파이프라인 폴더를 마우스 오른쪽 단추로 클릭하고 **프로젝트에 포함**을 선택하여 프로젝트에 파이프라인 및 추가 기능 어셈블리 포함.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="ea0ed-220">**속성** 창에서 각 파이프라인 어셈블리 및 추가 기능 어셈블리의 **빌드 작업**을 **콘텐츠**로 설정.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="ea0ed-221">마지막 단계에서는 다운로드할 파이프라인 어셈블리 파일과 추가 기능 어셈블리 파일을 포함하도록 응용 프로그램 매니페스트를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="ea0ed-222">파일은 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 응용 프로그램이 차지하는 [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 캐시의 폴더 루트에 있는 폴더에 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="ea0ed-223">구성은 [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]에서 다음을 수행하여 구현할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="ea0ed-224">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 프로젝트를 마우스 오른쪽 단추로 클릭하고, **속성**, **게시** 순으로 클릭한 다음 **응용 프로그램 파일** 단추를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="ea0ed-225">**응용 프로그램 파일** 대화 상자에서 각 파이프라인과 추가 기능 DLL의 **게시 상태**를 **포함(자동)**으로 설정하고 각 파이프라인과 추가 기능 DLL에 대해 **그룹 다운로드**을 **(필수)**로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="ea0ed-226">응용 프로그램 기준 위치에서 파이프라인과 추가 기능 사용</span><span class="sxs-lookup"><span data-stu-id="ea0ed-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="ea0ed-227">파이프라인 및 추가 기능이 [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 배포용으로 구성되면 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]와 동일한 [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 캐시 폴더에 다운로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="ea0ed-228">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]의 파이프라인과 추가 기능을 사용하려면 [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] 코드를 통해 응용 프로그램 기준 위치에서 가져와야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="ea0ed-229">파이프라인과 추가 기능을 사용하기 위한 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델의 다양한 형식과 멤버에서 이 시나리오를 위한 특수 지원을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="ea0ed-230">경로으로 식별 되는 첫째, 고 <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> 열거형 값입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="ea0ed-231">다음을 포함하는 파이프라인을 사용하기 위해 관련 추가 기능 멤버의 오버로드와 함께 이 값을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="ea0ed-232">호스트의 원본 사이트에 액세스</span><span class="sxs-lookup"><span data-stu-id="ea0ed-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="ea0ed-233">추가 기능이 원본 사이트의 파일을 참조할 수 있도록 호스트 응용 프로그램과 동일한 수준의 보안 격리로 추가 기능을 로드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="ea0ed-234">이 보안 수준으로 식별 되는 <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> 열거형 값에 전달 하 고는 <xref:System.AddIn.Hosting.AddInToken.Activate%2A> 메서드 추가 기능이 활성화 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="ea0ed-235">WPF 추가 기능 아키텍처</span><span class="sxs-lookup"><span data-stu-id="ea0ed-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="ea0ed-236">가장 높은 수준에서 앞서 설명한 것 처럼 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 수 있도록 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 구현 하는 추가 기능 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (에서 직접 또는 간접적으로 파생 된 <xref:System.Windows.FrameworkElement>)를 사용 하 여 <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> 및 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="ea0ed-237">결과 호스트 응용 프로그램 반환 되는 <xref:System.Windows.FrameworkElement> 에서 표시 되는 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 호스트 응용 프로그램에서입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="ea0ed-238">간단한 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 추가 기능 시나리오의 경우 개발자는 이 내용만 알면 충분합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="ea0ed-239">더 복잡한 시나리오의 경우, 특히 레이아웃, 리소스 및 데이터 바인딩과 같이 추가 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 서비스를 활용하려는 시나리오에서는 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]가 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 지원하는 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델을 확장하는 방법에 대해 자세히 알아야 이 방법의 이점과 한계를 이해할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="ea0ed-240">근본적으로 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]는 추가 기능에서 호스트 응용 프로그램으로 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 전달하지 않습니다. 대신 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]가 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 상호 운용성을 사용하여 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]에 대한 Win32 창 핸들을 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="ea0ed-241">이와 같이 추가 기능의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]가 호스트 응용 프로그램에 전달되면 다음이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="ea0ed-242">추가 기능 쪽에서 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]가 호스트 응용 프로그램이 표시할 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]의 창 핸들을 획득합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="ea0ed-243">창 핸들은 내부에 의해 캡슐화 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 에서 파생 된 클래스 <xref:System.Windows.Interop.HwndSource> 구현 <xref:System.AddIn.Contract.INativeHandleContract>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="ea0ed-244">이 클래스의 인스턴스 반환한 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> 호스트 응용 프로그램의 응용 프로그램 도메인에 추가 기능의 응용 프로그램 도메인 마샬링됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="ea0ed-245">호스트 응용 프로그램 쪽에서 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 가져오며는 <xref:System.Windows.Interop.HwndSource> 는 내부 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 에서 파생 된 클래스 <xref:System.Windows.Interop.HwndHost> 소비 및 <xref:System.AddIn.Contract.INativeHandleContract>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="ea0ed-246">이 클래스의 인스턴스 반환한 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> 호스트 응용 프로그램입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="ea0ed-247"><xref:System.Windows.Interop.HwndHost>표시 하기 위해 존재 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], 창 핸들에서 공백과 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="ea0ed-248">자세한 내용은 [WPF 및 Win32 상호 운용성](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="ea0ed-249">요약 하자면, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, 및 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> 에 대 한 창 핸들을 허용 하기 위해 존재는 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 로 캡슐화 되는 호스트 응용 프로그램에 전달할 추가 기능에서 <xref:System.Windows.Interop.HwndHost> 호스트를 표시 합니다. 응용 프로그램의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ea0ed-250">호스트 응용 프로그램 가져오기 때문에 <xref:System.Windows.Interop.HwndHost>, 호스트 응용 프로그램에서 반환 되는 개체를 변환할 수 없습니다 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> 형식에 의해 구현 되며으로에서 추가 기능 (예를 들어 한 <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="ea0ed-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="ea0ed-251">기본적으로 <xref:System.Windows.Interop.HwndHost> 호스트 응용 프로그램 수 사용 하는 방법에 영향을 주는 특정 제한 사항이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="ea0ed-252">그러나 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 확장 <xref:System.Windows.Interop.HwndHost> 추가 시나리오에 대 한 몇 가지 기능을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="ea0ed-253">이러한 이점과 한계는 아래에 설명되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="ea0ed-254">WPF 추가 기능의 이점</span><span class="sxs-lookup"><span data-stu-id="ea0ed-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="ea0ed-255">때문에 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 추가 기능에서 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] 에서 파생 되는 내부 클래스를 사용 하 여 호스트 응용 프로그램에서 표시 <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] 의 기능에 의해 제한 <xref:System.Windows.Interop.HwndHost> 와 관련 하 여 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 레이아웃, 렌더링, 데이터 바인딩, 스타일, 템플릿 및 리소스 등의 서비스입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="ea0ed-256">그러나 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 내부 확대 <xref:System.Windows.Interop.HwndHost> 하위 클래스에 다음을 포함 하는 추가 기능:</span><span class="sxs-lookup"><span data-stu-id="ea0ed-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="ea0ed-257">호스트 응용 프로그램의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]와 추가 기능의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 간 탭 이동.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="ea0ed-258">"인 추가 기능 한 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" 프로그래밍 모델에서는 재정의를 추가 기능 측 어댑터 <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> 탭 이동, 추가 기능에 완벽 하 게 신뢰 되지 않거나 부분적으로 신뢰할 수 있는 여부를 사용 하도록 설정 하려면.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="ea0ed-259">호스트 응용 프로그램 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]에서 표시된 추가 기능 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]의 접근성 요구 사항 준수.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="ea0ed-260">여러 응용 프로그램 도메인 시나리오에서 안전하게 실행되도록 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 응용 프로그램 사용.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="ea0ed-261">추가 기능이 보안 격리(즉, 부분적으로 신뢰되는 보안 샌드박스) 상태에서 실행되는 경우 추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 창 핸들에 대한 무단 액세스 방지.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="ea0ed-262">호출 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> 이 보안을 위해:</span><span class="sxs-lookup"><span data-stu-id="ea0ed-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="ea0ed-263">에 대 한는 "반환 추가 기능을 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" 프로그래밍 모델, 추가 기능에 대 한 창 핸들을 전달 하는 유일한 방법은 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 간에 격리 경계를 호출 하는 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="ea0ed-264">에 대 한는 "인 추가 기능 한 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" 프로그래밍 모델을 재정의 <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> 호출 되며 추가 기능 측 어댑터 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (이전 예제에서와 같이) 이므로 필요한 경우 추가 기능 측 어댑터를 호출 하는 대로 `QueryContract` 구현 호스트 측 어댑터.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="ea0ed-265">여러 응용 프로그램 도메인 실행 보호 제공.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="ea0ed-266">응용 프로그램 도메인의 한계로 인해 추가 기능 응용 프로그램 도메인에서 throw된 처리되지 않은 예외가 발생하면 격리 경계가 있는 경우에도 전체 응용 프로그램이 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="ea0ed-267">그러나 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]와 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 추가 기능 모델은 이 문제에 대한 간단한 해결 방법을 제공하고 응용 프로그램 안정성을 향상시킵니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="ea0ed-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 추가 기능을 표시 하는 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 만듭니다는 <xref:System.Windows.Threading.Dispatcher> 호스트 응용 프로그램은 응용 프로그램 도메인을 실행 하는 스레드는 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 응용 프로그램입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="ea0ed-269">처리 하 여 응용 프로그램 도메인에서 발생 하는 처리 되지 않은 모든 예외를 검색할 수 있습니다는 <xref:System.Windows.Threading.Dispatcher.UnhandledException> 의 이벤트는 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 추가 기능에 해당 <xref:System.Windows.Threading.Dispatcher>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="ea0ed-270">가져올 수는 <xref:System.Windows.Threading.Dispatcher> 에서 <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="ea0ed-271">WPF 추가 기능 한계</span><span class="sxs-lookup"><span data-stu-id="ea0ed-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="ea0ed-272">이점 외 하 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 에서 제공 하는 기본 동작에 추가 <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, 창 핸들 및 추가 기능에 대 한 제한도 있습니다. [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] 호스트 응용 프로그램에서 표시 되는:</span><span class="sxs-lookup"><span data-stu-id="ea0ed-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="ea0ed-273">호스트 응용 프로그램에서 표시되는 추가 기능 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]은 호스트 응용 프로그램의 클리핑 동작을 준수하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="ea0ed-274">상호 운용성 시나리오의 *에어스페이스* 개념도 추가 기능에 적용됩니다([기술 영역 개요](../../../../docs/framework/wpf/advanced/technology-regions-overview.md) 참조).</span><span class="sxs-lookup"><span data-stu-id="ea0ed-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="ea0ed-275">리소스 상속, 데이터 바인딩 및 명령과 같은 호스트 응용 프로그램의 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 서비스를 추가 기능 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]에서 자동으로 사용할 수 있는 것은 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="ea0ed-276">추가 기능에 이러한 서비스를 제공하려면 파이프라인을 업데이트해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="ea0ed-277">추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]는 회전하거나, 배율을 조정하거나 기울일 수 없으며 변환을 통해 달리 변경할 수 없습니다([변환 개요](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md) 참조).</span><span class="sxs-lookup"><span data-stu-id="ea0ed-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="ea0ed-278">추가 기능에서 내부 콘텐츠 [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] 그리기 작업에서으로 렌더링 되는 <xref:System.Drawing> 알파 혼합 네임 스페이스를 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="ea0ed-279">그러나 추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]와 이를 포함하는 호스트 응용 프로그램 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]는 모두 100% 불투명한 상태여야 합니다. 즉, 두 가지 모두 `Opacity` 속성이 1로 설정되어 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="ea0ed-280">경우는 <xref:System.Windows.Window.AllowsTransparency%2A> 추가 기능을 포함 하는 호스트 응용 프로그램에서 창의 속성 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 로 설정 된 `true`, 추가 기능에 보이지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="ea0ed-281">이는 추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]가 100% 불투명한 경우(즉, `Opacity` 속성의 값이 1임)에도 마찬가지입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="ea0ed-282">추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]는 동일한 최상위 창의 다른 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 요소 위에 표시되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="ea0ed-283">추가 기능에서 부분 없습니다 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 를 사용 하 여 렌더링할 수는 <xref:System.Windows.Media.VisualBrush>합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="ea0ed-284">대신 추가 기능은 생성된 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]의 스냅숏을 사용하여 계약에 정의된 메서드를 통해 호스트 응용 프로그램에 전달할 수 있는 비트맵을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="ea0ed-285">미디어 파일을 재생할 수 없습니다는 <xref:System.Windows.Controls.MediaElement> 추가 기능에서 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="ea0ed-286">추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]용으로 생성된 마우스 이벤트는 호스트 응용 프로그램을 통해 생성되거나 발생되지 않으며 호스트 응용 프로그램 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]의 `IsMouseOver`의 속성 값이 `false`입니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="ea0ed-287">추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]의 컨트롤 간에 포커스가 이동할 때 호스트 응용 프로그램에서 `GotFocus` 및 `LostFocus` 이벤트를 받거나 발생시키지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="ea0ed-288">추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]를 포함하는 호스트 응용 프로그램의 부분은 인쇄 시 흰색으로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="ea0ed-289">모든 디스패처 (참조 <xref:System.Windows.Threading.Dispatcher>) 추가 기능에서 만든 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 종료 해야 수동으로 소유자 추가 기능 언로드되기 전에 호스트 응용 프로그램 실행을 계속 하는 경우.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="ea0ed-290">계약에서 추가 기능이 언로드되기 전에 호스트 응용 프로그램에서 추가 기능에 신호를 보낼 수 있도록 하는 메서드를 구현할 수 있으므로 이를 통해 추가 기능 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]가 디스패처를 종료할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="ea0ed-291">추가 기능을 하는 경우 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 은 <xref:System.Windows.Controls.InkCanvas> 같거나는 <xref:System.Windows.Controls.InkCanvas>, 추가 기능을 언로드할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="ea0ed-292">성능 최적화</span><span class="sxs-lookup"><span data-stu-id="ea0ed-292">Performance Optimization</span></span>  
 <span data-ttu-id="ea0ed-293">기본적으로 여러 응용 프로그램 도메인을 사용할 경우 각 응용 프로그램에 필요한 다양한 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 어셈블리가 응용 프로그램의 도메인에 모두 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="ea0ed-294">결과적으로 새 응용 프로그램 도메인을 만들고 이 도메인의 응용 프로그램을 시작하는 데 필요한 시간이 성능에 영향을 미칠 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="ea0ed-295">그러나 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]에서는 응용 프로그램이 이미 로드된 경우 응용 프로그램 도메인 전체에서 어셈블리를 공유하도록 응용 프로그램에 지시하여 시작 시간을 줄이는 방법을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="ea0ed-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="ea0ed-296">사용 하 여이 작업을 수행 된 <xref:System.LoaderOptimizationAttribute> 진입점 메서드에 적용 해야 하는 특성 (`Main`).</span><span class="sxs-lookup"><span data-stu-id="ea0ed-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="ea0ed-297">이 경우, 응용 프로그램 정의를 구현하는 코드만 사용해야 합니다([응용 프로그램 관리 개요](../../../../docs/framework/wpf/app-development/application-management-overview.md) 참조).</span><span class="sxs-lookup"><span data-stu-id="ea0ed-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea0ed-298">참고 항목</span><span class="sxs-lookup"><span data-stu-id="ea0ed-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="ea0ed-299">추가 기능 및 확장성</span><span class="sxs-lookup"><span data-stu-id="ea0ed-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="ea0ed-300">응용 프로그램 도메인</span><span class="sxs-lookup"><span data-stu-id="ea0ed-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="ea0ed-301">.NET framework Remoting 개요</span><span class="sxs-lookup"><span data-stu-id="ea0ed-301">.NET Framework Remoting Overview</span></span>](http://msdn.microsoft.com/en-us/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="ea0ed-302">원격 가능 개체 만들기</span><span class="sxs-lookup"><span data-stu-id="ea0ed-302">Making Objects Remotable</span></span>](http://msdn.microsoft.com/en-us/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="ea0ed-303">방법 항목</span><span class="sxs-lookup"><span data-stu-id="ea0ed-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
