---
title: '연습: Win32에서 WPF 콘텐츠 호스팅'
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 02f0831b46b8087c48b86e83a4b20f94bf3b79d0
ms.sourcegitcommit: 24a4a8eb6d8cfe7b8549fb6d823076d7c697e0c6
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/23/2019
ms.locfileid: "68401585"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="b2f98-102">연습: Win32에서 WPF 콘텐츠 호스팅</span><span class="sxs-lookup"><span data-stu-id="b2f98-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="b2f98-103">에서는 응용 프로그램을 만들기 위한 다양한 환경을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-103">provides a rich environment for creating applications.</span></span> <span data-ttu-id="b2f98-104">그러나 [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] 코드에 상당한 투자를 한 경우 원본 코드를 다시 작성하는 대신 응용 프로그램에 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 기능을 추가하는 것이 더 효과적일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="b2f98-105">창에서 콘텐츠를 호스트 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 하기 위한 간단한 메커니즘을 제공 합니다. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b2f98-105">provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="b2f98-106">이 자습서에서는 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 창에서 콘텐츠를 호스트 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 하는 샘플 응용 프로그램 ( [Win32 창에서 WPF 콘텐츠 호스팅 샘플](https://go.microsoft.com/fwlink/?LinkID=160004))을 작성 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="b2f98-107">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 창을 호스트하도록 이 샘플을 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="b2f98-108">관리 코드와 비관리 코드를 혼합해서 사용하므로 응용 프로그램은 [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]로 작성되었습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  

<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="b2f98-109">요구 사항</span><span class="sxs-lookup"><span data-stu-id="b2f98-109">Requirements</span></span>  
 <span data-ttu-id="b2f98-110">이 자습서에서는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 및 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 프로그래밍에 대한 기본 지식이 있다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="b2f98-111">프로그래밍에 대 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 한 기본적인 소개는 [시작](../getting-started/index.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="b2f98-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md).</span></span> <span data-ttu-id="b2f98-112">프로그래밍에 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 대 한 소개를 보려면 특히 Charles Petzold의 *프로그래밍 창* 에서 주제에 대 한 다양 한 책을 참조 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="b2f98-113">이 자습서와 함께 제공 되는 샘플은에서 [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]구현 되었으므로이 자습서에서는를 [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] 사용 하 여 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]API를 프로그래밍 하는 방법과 관리 코드 프로그래밍에 대해 잘 알고 있다고 가정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]API plus an understanding of managed code programming.</span></span> <span data-ttu-id="b2f98-114">[!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]에 대한 지식이 있으면 도움이 되지만 필수 사항은 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b2f98-115">이 자습서에는 관련 샘플의 많은 코드 예제가 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="b2f98-116">그러나 가독성을 위해 전체 샘플 코드를 포함하지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="b2f98-117">전체 샘플 코드는 [Win32 창에서 WPF 콘텐츠 호스팅 샘플](https://go.microsoft.com/fwlink/?LinkID=160004)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="b2f98-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="b2f98-118">기본 절차</span><span class="sxs-lookup"><span data-stu-id="b2f98-118">The Basic Procedure</span></span>  
 <span data-ttu-id="b2f98-119">이 섹션에서는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 창에서 콘텐츠를 호스트 하는 데 사용 하는 기본 절차를 간략하게 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="b2f98-120">나머지 섹션에서는 각 단계를 자세히 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="b2f98-121">창 에서콘텐츠[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 를 호스트 하는 열쇠는 클래스입니다.<xref:System.Windows.Interop.HwndSource> [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b2f98-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="b2f98-122">이 클래스는 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 창 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 에서 콘텐츠를 래핑하여에 [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] 자식 창으로 통합 될 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="b2f98-123">다음 접근 방식은 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 및 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]를 단일 애플리케이션에 결합합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="b2f98-124">콘텐츠를 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 관리 되는 클래스로 구현 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2. <span data-ttu-id="b2f98-125">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]를 사용하여 [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] 응용 프로그램을 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="b2f98-126">기존 응용 프로그램과 비관리 [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] 코드로 시작하는 경우 일반적으로 `/clr` 컴파일러 플래그를 포함하도록 프로젝트 설정을 변경하여 관리 코드를 호출할 수 있게 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3. <span data-ttu-id="b2f98-127">스레딩 모델을 STA(단일 스레드 아파트)로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4. <span data-ttu-id="b2f98-128">창 프로시저에서 [WM_CREATE](/windows/desktop/winmsg/wm-create)알림을 처리 하 고 다음을 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1. <span data-ttu-id="b2f98-129">부모 창을 해당 <xref:System.Windows.Interop.HwndSource> 매개 변수로 사용하여 새 `parent` 개체를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="b2f98-130">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="b2f98-131">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 개체에 대 한 참조를의 <xref:System.Windows.Interop.HwndSource.RootVisual%2A> <xref:System.Windows.Interop.HwndSource>속성에 할당 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4. <span data-ttu-id="b2f98-132">콘텐츠에 대한 HWND를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-132">Get the HWND for the content.</span></span> <span data-ttu-id="b2f98-133"><xref:System.Windows.Interop.HwndSource.Handle%2A> 개체의 <xref:System.Windows.Interop.HwndSource> 속성에는 창 핸들(HWND)이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="b2f98-134">애플리케이션의 관리되지 않는 부분에서 사용할 수 있는 HWND를 가져오려면 `Handle.ToPointer()`를 HWND로 캐스팅합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5. <span data-ttu-id="b2f98-135">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠에 대한 참조를 보유할 정적 필드가 포함된 관리되는 클래스를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-136">이 클래스를 통해 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 코드에서 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 콘텐츠에 대한 참조를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6. <span data-ttu-id="b2f98-137">정적 필드에 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠를 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7. <span data-ttu-id="b2f98-138">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 하나[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 이상의 이벤트에 처리기를 연결 하 여 콘텐츠에서 알림을 받습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8. <span data-ttu-id="b2f98-139">정적 필드에 저장된 참조를 통해 속성 등을 설정하여 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠와 통신합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b2f98-140">를 사용 [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] 하 여 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠를 구현할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-141">그러나 별도로 [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)]로 컴파일하고 [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] 응용 프로그램에서 해당 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]을 참조해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="b2f98-142">프로시저의 나머지 부분은 위에서 설명한 것과 비슷합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="b2f98-143">호스트 애플리케이션 구현</span><span class="sxs-lookup"><span data-stu-id="b2f98-143">Implementing the Host Application</span></span>
 <span data-ttu-id="b2f98-144">이 섹션에서는 기본 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 응용 프로그램에서 콘텐츠를 호스트 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="b2f98-145">콘텐츠 자체는 [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]에서 관리되는 클래스로 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="b2f98-146">대부분의 경우 간단한 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 프로그래밍입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="b2f98-147">콘텐츠 구현의 주요 측면은 [WPF 콘텐츠 구현](#implementing_the_wpf_page)에서 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

<a name="autoNestedSectionsOUTLINE1"></a>
- [<span data-ttu-id="b2f98-148">기본 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="b2f98-148">The Basic Application</span></span>](#the_basic_application)

- [<span data-ttu-id="b2f98-149">WPF 콘텐츠 호스트</span><span class="sxs-lookup"><span data-stu-id="b2f98-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

- [<span data-ttu-id="b2f98-150">WPF 콘텐츠에 대한 참조 보유</span><span class="sxs-lookup"><span data-stu-id="b2f98-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

- [<span data-ttu-id="b2f98-151">WPF 콘텐츠와 통신</span><span class="sxs-lookup"><span data-stu-id="b2f98-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="b2f98-152">기본 애플리케이션</span><span class="sxs-lookup"><span data-stu-id="b2f98-152">The Basic Application</span></span>
 <span data-ttu-id="b2f98-153">호스트 응용 프로그램의 시작점은 Visual Studio 2005 템플릿을 만드는 것 이었습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1. <span data-ttu-id="b2f98-154">Visual Studio 2005을 열고 **파일** 메뉴에서 **새 프로젝트** 를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2. <span data-ttu-id="b2f98-155">[!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] 프로젝트 형식 목록에서 **Win32** 를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="b2f98-156">기본 언어가가 아닌 [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)]경우 이러한 프로젝트 형식은 **다른 언어**아래에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>

3. <span data-ttu-id="b2f98-157">**Win32 프로젝트** 템플릿을 선택 하 고 프로젝트에 이름을 할당 한 다음 **확인** 을 클릭 하 여 **win32 응용 프로그램 마법사**를 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4. <span data-ttu-id="b2f98-158">마법사의 기본 설정을 그대로 적용 하 고 **마침** 을 클릭 하 여 프로젝트를 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="b2f98-159">템플릿은 다음을 포함하여 기본 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 응용 프로그램을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>

- <span data-ttu-id="b2f98-160">애플리케이션에 대한 진입점</span><span class="sxs-lookup"><span data-stu-id="b2f98-160">An entry point for the application.</span></span>

- <span data-ttu-id="b2f98-161">연결된 창 프로시저(WndProc)가 있는 창</span><span class="sxs-lookup"><span data-stu-id="b2f98-161">A window, with an associated window procedure (WndProc).</span></span>

- <span data-ttu-id="b2f98-162">**파일** 및 **도움말** 머리글이 있는 메뉴입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="b2f98-163">**파일** 메뉴에는 응용 프로그램을 닫는 **끝내기** 항목이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="b2f98-164">**도움말** 메뉴에는 간단한 대화 상자를 시작 하는 **About** 항목이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="b2f98-165">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠를 호스트할 코드 작성을 시작 하기 전에 기본 템플릿을 두 번 수정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="b2f98-166">첫 번째는 프로젝트를 관리 코드로 컴파일하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="b2f98-167">기본적으로 프로젝트는 비관리 코드로 컴파일됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="b2f98-168">그러나 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]가 관리 코드에서 구현되었으므로 프로젝트도 그에 따라 컴파일해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1. <span data-ttu-id="b2f98-169">**솔루션 탐색기** 에서 프로젝트 이름을 마우스 오른쪽 단추로 클릭 하 고 상황에 맞는 메뉴에서 **속성** 을 선택 하 여 **속성 페이지** 대화 상자를 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2. <span data-ttu-id="b2f98-170">왼쪽 창의 트리 뷰에서 **구성 속성** 을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3. <span data-ttu-id="b2f98-171">오른쪽 창의 **프로젝트 기본값** 목록에서 **공용 언어 런타임** 지원을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4. <span data-ttu-id="b2f98-172">드롭다운 목록 상자에서 **공용 언어 런타임 지원 (/clr)** 을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
>  <span data-ttu-id="b2f98-173">이 컴파일러 플래그를 통해 애플리케이션에서 관리 코드를 사용할 수 있지만 비관리 코드는 계속 이전처럼 컴파일됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="b2f98-174">는 STA(단일 스레드 아파트) 스레딩 모델을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-174">uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="b2f98-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 코드에서 제대로 작동 하려면 진입점에 특성을 적용 하 여 응용 프로그램의 스레딩 모델을 STA로 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="b2f98-176">WPF 콘텐츠 호스트</span><span class="sxs-lookup"><span data-stu-id="b2f98-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="b2f98-177">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠는 간단한 주소 입력 응용 프로그램입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="b2f98-178">사용자 이름, 주소 등을 가져오는 여러 개의 <xref:System.Windows.Controls.TextBox> 컨트롤로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="b2f98-179">두 개의 <xref:System.Windows.Controls.Button> 컨트롤인 **확인** 과 **취소**도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="b2f98-180">사용자가 **확인**을 클릭 하면 단추의 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 이벤트 처리기가 <xref:System.Windows.Controls.TextBox> 컨트롤에서 데이터를 수집 하 고 해당 속성에 할당 한 다음 사용자 지정 이벤트를 `OnButtonClicked`발생 시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="b2f98-181">사용자가 **취소**를 클릭 하면 처리기가 발생 `OnButtonClicked`합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="b2f98-182">`OnButtonClicked`에 대한 이벤트 인수 개체에는 클릭된 단추를 나타내는 부울 필드가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="b2f98-183">콘텐츠를 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 호스트 하는 코드는 호스트 창의 [WM_CREATE](/windows/desktop/winmsg/wm-create) 알림에 대 한 처리기에서 구현 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="b2f98-184">메서드 `GetHwnd` 는 크기 및 위치 정보와 부모 창 핸들을 사용 하 고 호스트 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 된 콘텐츠의 창 핸들을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
>  <span data-ttu-id="b2f98-185">`#using` 네임스페이스에는 `System::Windows::Interop` 지시문을 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="b2f98-186">사용할 경우 해당 네임스페이스의 <xref:System.Windows.Interop.MSG> 구조와 winuser.h에 선언된 MSG 구조 간에 이름 충돌이 생깁니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="b2f98-187">대신 정규화된 이름을 사용하여 해당 네임스페이스의 내용에 액세스해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="b2f98-188">응용 프로그램 창에서 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 직접 콘텐츠를 호스트할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="b2f98-189"><xref:System.Windows.Interop.HwndSource> 콘텐츠를 래핑할 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 개체를 먼저 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-190">이 개체는 기본적으로 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠를 호스트 하도록 설계 된 창입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-191">응용 프로그램의 <xref:System.Windows.Interop.HwndSource> 일부인 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 창의 자식으로 만들어 부모 창에서 개체를 호스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="b2f98-192"><xref:System.Windows.Interop.HwndSource> 생성자 매개 변수에는 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 자식 창을 만들 때 CreateWindow에 전달하는 것과 동일한 정보가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>

 <span data-ttu-id="b2f98-193">다음에는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 개체의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="b2f98-194">이 경우 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠는 `WPFPage`를 사용하여 별도 클래스 [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]로 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="b2f98-195">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]을 통해 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 콘텐츠를 구현할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="b2f98-196">그러나 이렇게 하려면 별도의 프로젝트를 설정 하 고 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠를 [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]로 빌드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="b2f98-197">[!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]에 대한 참조를 프로젝트에 추가하고 해당 참조를 사용하여 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠의 인스턴스를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="b2f98-198">콘텐츠에 대 한 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Interop.HwndSource.RootVisual%2A> 참조를의 속성 <xref:System.Windows.Interop.HwndSource>에 할당 하 여 자식 창에 콘텐츠를 표시 합니다. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b2f98-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="b2f98-199">코드의 다음 줄에서는 이벤트 처리기 `WPFButtonClicked`를 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 `OnButtonClicked` 이벤트에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="b2f98-200">이 처리기는 사용자가 **확인** 또는 **취소** 단추를 클릭할 때 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="b2f98-201">이 이벤트 처리기에 대 한 자세한 내용은 [communicating_with_the_WPF 콘텐츠](#communicating_with_the_page) 를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="b2f98-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="b2f98-202">표시된 코드의 마지막 줄에서는 <xref:System.Windows.Interop.HwndSource> 개체와 연결된 창 핸들(HWND)을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="b2f98-203">샘플에서는 수행하지 않지만 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 코드에서 이 핸들을 사용하여 호스트된 창에 메시지를 보낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="b2f98-204"><xref:System.Windows.Interop.HwndSource> 개체는 메시지를 받을 때마다 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="b2f98-205">메시지를 처리하려면 <xref:System.Windows.Interop.HwndSource.AddHook%2A> 메서드를 호출하여 메시지 처리기를 연결한 다음 해당 처리기에서 메시지를 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="b2f98-206">WPF 콘텐츠에 대한 참조 보유</span><span class="sxs-lookup"><span data-stu-id="b2f98-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="b2f98-207">대부분의 응용 프로그램에서는 나중에 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠와 통신하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="b2f98-208">예를 들어 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 속성을 수정하거나 <xref:System.Windows.Interop.HwndSource> 개체가 다른 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠를 호스트하게 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-209">이렇게 하려면 <xref:System.Windows.Interop.HwndSource> 개체 또는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠에 대한 참조가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-210"><xref:System.Windows.Interop.HwndSource> 개체 및 연결된 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠는 창 핸들을 삭제할 때까지 메모리에 남아 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="b2f98-211">그러나 <xref:System.Windows.Interop.HwndSource> 개체에 할당하는 변수는 창 프로시저에서 반환되는 즉시 범위를 벗어납니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="b2f98-212">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 응용 프로그램에서 이 문제를 처리하는 일반적인 방법은 정적 변수나 전역 변수를 사용하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="b2f98-213">이러한 유형의 변수에는 관리되는 개체를 할당할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="b2f98-214"><xref:System.Windows.Interop.HwndSource> 개체와 연결된 창 핸들을 전역 변수나 정적 변수에 할당할 수 있지만 개체 자체에 대한 액세스는 제공되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="b2f98-215">이 문제에 대한 가장 간단한 해결 방법은 액세스해야 하는 관리되는 개체에 대한 참조를 보유할 정적 필드 집합이 포함된 관리되는 클래스를 구현하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="b2f98-216">샘플에서는 `WPFPageHost` 클래스를 사용하여 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠에 대한 참조 및 나중에 사용자가 변경할 수 있는 여러 해당 속성의 초기 값을 보유합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="b2f98-217">이는 헤더에서 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="b2f98-218">`GetHwnd` 함수의 뒷부분에서는 나중에 `myPage`가 범위 내에 있는 동안 사용하기 위해 해당 필드에 값을 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="b2f98-219">WPF 콘텐츠와 통신</span><span class="sxs-lookup"><span data-stu-id="b2f98-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="b2f98-220">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠와의 통신에는 두 가지 유형이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-221">응용 프로그램은 사용자가 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] **확인** 또는 **취소** 단추를 클릭할 때 콘텐츠에서 정보를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="b2f98-222">응용 프로그램에는 사용자가 배경색 또는 기본 글꼴 크기와 같은 다양한 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 콘텐츠 속성을 변경할 수 있게 해주는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="b2f98-223">위에서 설명했듯이 사용자가 단추 중 하나를 클릭하면 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠에서 `OnButtonClicked` 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="b2f98-224">애플리케이션은 이 이벤트에 처리기를 연결하여 이러한 알림을 수신합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="b2f98-225">**확인** 단추를 클릭 한 경우 처리기는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠에서 사용자 정보를 가져오고 정적 컨트롤 집합에 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="b2f98-226">처리기는 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠로부터 사용자 지정 이벤트 인수 개체 `MyPageEventArgs`를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="b2f98-227">확인 단추를 `IsOK` 클릭 한 경우 개체 `true` 의 속성이  로 설정 되 고, `false` **취소** 단추를 클릭 한 경우로 설정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="b2f98-228">**확인** 단추를 클릭 한 경우 처리기는 컨테이너 클래스에서 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠에 대 한 참조를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="b2f98-229">그런 다음 연결된 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 속성에 보유된 사용자 정보를 수집하고 정적 컨트롤을 사용하여 부모 창에 정보를 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="b2f98-230">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 데이터는 관리되는 문자열 형식이므로 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 컨트롤에서 사용하기 위해 마샬링해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="b2f98-231">**취소** 단추를 클릭 한 경우 처리기는 정적 컨트롤에서 데이터를 지웁니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="b2f98-232">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 응용 프로그램은 사용자가 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠의 배경색 및 여러 글꼴 관련 속성을 수정할 수 있게 해주는 라디오 단추 집합을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="b2f98-233">다음 예제는 애플리케이션의 창 프로시저(WndProc) 및 각 메시지에서 배경색을 비롯한 다양한 속성을 설정하는 해당 메시지 처리에서 발췌한 내용입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="b2f98-234">다른 예제도 비슷하며 표시되지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="b2f98-235">자세한 내용과 컨텍스트는 전체 샘플을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b2f98-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="b2f98-236">배경색을 설정하려면 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]에서 `hostedPage` 콘텐츠(`WPFPageHost`)에 대한 참조를 가져오고 배경색 속성을 적절한 색으로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="b2f98-237">샘플에서는 세 가지 색 옵션(원래 색, 연한 녹색 또는 연한 연어살색)을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="b2f98-238">원래 배경색은 `WPFPageHost` 클래스에 정적 필드로 저장되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="b2f98-239">다른 두 색을 설정하기 위해 <xref:System.Windows.Media.SolidColorBrush> 개체를 새로 만들고 생성자에 <xref:System.Windows.Media.Colors> 개체의 정적 색 값을 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="b2f98-240">WPF 페이지 구현</span><span class="sxs-lookup"><span data-stu-id="b2f98-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="b2f98-241">실제 구현에 대 한 지식 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 없이 콘텐츠를 호스트 하 고 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="b2f98-242">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠가 별도[!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)]의에 패키지 된 경우 CLR (공용 언어 런타임) 언어로 빌드된 것일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any common language runtime (CLR) language.</span></span> <span data-ttu-id="b2f98-243">다음은 샘플에서 사용된 [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] 구현의 간단한 연습입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="b2f98-244">이 섹션에는 다음 하위 섹션이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-244">This section contains the following subsections.</span></span>

<a name="autoNestedSectionsOUTLINE2"></a>
- [<span data-ttu-id="b2f98-245">레이아웃</span><span class="sxs-lookup"><span data-stu-id="b2f98-245">Layout</span></span>](#page_layout)

- [<span data-ttu-id="b2f98-246">호스트 창에 데이터 반환</span><span class="sxs-lookup"><span data-stu-id="b2f98-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

- [<span data-ttu-id="b2f98-247">WPF 속성 설정</span><span class="sxs-lookup"><span data-stu-id="b2f98-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="b2f98-248">레이아웃</span><span class="sxs-lookup"><span data-stu-id="b2f98-248">Layout</span></span>
 <span data-ttu-id="b2f98-249">콘텐츠의 요소 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]는연결 <xref:System.Windows.Controls.TextBox> 된<xref:System.Windows.Controls.Label> 컨트롤을 포함 하는 5 개의 컨트롤로 구성 됩니다. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 이름, 주소, 구/군/시, 시/도 및 우편 번호입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="b2f98-250">두 개의 <xref:System.Windows.Controls.Button> 컨트롤인 **확인** 과 **취소** 도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="b2f98-251">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠는 `WPFPage` 클래스에서 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="b2f98-252">레이아웃은 <xref:System.Windows.Controls.Grid> 레이아웃 요소에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="b2f98-253">클래스는 <xref:System.Windows.Controls.Grid>에서 상속되며 효과적으로 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 루트 요소로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="b2f98-254">콘텐츠 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 생성자는 필요한 너비와 높이를 사용 하 고 <xref:System.Windows.Controls.Grid> 크기를 적절히 조정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="b2f98-255"><xref:System.Windows.Controls.ColumnDefinition> 그런 다음 <xref:System.Windows.Controls.Grid.RowDefinitions%2A> 및 <xref:System.Windows.Controls.RowDefinition> 개체 집합을 만들어 각각 <xref:System.Windows.Controls.Grid> 개체 기본 <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> 및 컬렉션에 추가 하 여 기본 레이아웃을 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="b2f98-256">그러면 크기가 셀의 내용에 따라 결정되는 5개의 행과 7개의 열로 구성된 표가 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="b2f98-257">다음에는 생성자가 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]에 <xref:System.Windows.Controls.Grid> 요소를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="b2f98-258">첫 번째 요소는 표의 첫 번째 행 가운데에 표시되는 <xref:System.Windows.Controls.Label> 컨트롤인 제목 텍스트입니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="b2f98-259">다음 행에는 Name <xref:System.Windows.Controls.Label> 컨트롤 및 연결된 <xref:System.Windows.Controls.TextBox> 컨트롤이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="b2f98-260">동일한 코드가 각 레이블/텍스트 상자 쌍에 사용되므로 private 메서드 쌍에 배치되고 레이블/텍스트 상자 쌍 5개에 모두 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="b2f98-261">메서드는 적절한 컨트롤을 만들고 <xref:System.Windows.Controls.Grid> 클래스의 정적 <xref:System.Windows.Controls.Grid.SetColumn%2A> 및 <xref:System.Windows.Controls.Grid.SetRow%2A> 메서드를 호출하여 컨트롤을 적절한 셀에 배치합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="b2f98-262">컨트롤이 만들어진 후 샘플에서는 <xref:System.Windows.Controls.UIElementCollection.Add%2A>의 <xref:System.Windows.Controls.Panel.Children%2A> 속성에 대해 <xref:System.Windows.Controls.Grid> 메서드를 호출하여 표에 컨트롤을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="b2f98-263">나머지 레이블/텍스트 상자 쌍을 추가하는 코드도 비슷합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="b2f98-264">자세한 내용은 샘플 코드를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b2f98-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="b2f98-265">두 메서드의 구현은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="b2f98-266">마지막으로이 샘플에서는 **확인** 및 **취소** 단추를 추가 하 고 이벤트 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 처리기를 이벤트에 연결 합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="b2f98-267">호스트 창에 데이터 반환</span><span class="sxs-lookup"><span data-stu-id="b2f98-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="b2f98-268">단추 중 하나를 클릭하면 해당 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 이벤트가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="b2f98-269">호스트 창은 단순히 이러한 이벤트에 처리기를 연결하고 <xref:System.Windows.Controls.TextBox> 컨트롤에서 직접 데이터를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="b2f98-270">샘플에서는 상대적으로 덜 직접적인 접근 방식을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="b2f98-271">콘텐츠 내에서 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 를 처리 한 다음 사용자 지정 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 이벤트 `OnButtonClicked`를 발생 시켜 콘텐츠에 알립니다. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b2f98-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="b2f98-272">이렇게 하면 호스트 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 에 알리기 전에 콘텐츠에서 일부 매개 변수 유효성 검사를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="b2f98-273">처리기는 <xref:System.Windows.Controls.TextBox> 컨트롤에서 텍스트를 가져와 호스트가 정보를 검색할 수 있는 public 속성에 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="b2f98-274">WPFPage.h의 이벤트 선언:</span><span class="sxs-lookup"><span data-stu-id="b2f98-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="b2f98-275">WPFPage.cpp의 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 이벤트 처리기:</span><span class="sxs-lookup"><span data-stu-id="b2f98-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="b2f98-276">WPF 속성 설정</span><span class="sxs-lookup"><span data-stu-id="b2f98-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="b2f98-277">호스트를 통해 사용자는 여러 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 속성을 변경할 수 있습니다. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b2f98-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="b2f98-278">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 쪽에서는 단순히 속성을 변경하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="b2f98-279">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 콘텐츠 클래스의 구현은 모든 컨트롤의 글꼴을 제어하는 단일 전역 속성이 없기 때문에 다소 복잡합니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="b2f98-280">대신, 각 컨트롤에 적절한 속성이 속성의 set 접근자에서 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="b2f98-281">다음 예제에서는 `DefaultFontFamily` 속성에 대 한 코드를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="b2f98-282">속성을 설정하면 private 메서드가 호출되고, 다시 다양한 컨트롤에 대한 <xref:System.Windows.Controls.Control.FontFamily%2A> 속성이 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="b2f98-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="b2f98-283">WPFPage.h에서:</span><span class="sxs-lookup"><span data-stu-id="b2f98-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="b2f98-284">WPFPage.cpp에서:</span><span class="sxs-lookup"><span data-stu-id="b2f98-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="b2f98-285">참고자료</span><span class="sxs-lookup"><span data-stu-id="b2f98-285">See also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="b2f98-286">WPF 및 Win32 상호 운용성</span><span class="sxs-lookup"><span data-stu-id="b2f98-286">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
