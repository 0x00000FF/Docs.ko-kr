---
title: 서버 쪽 UI 자동화 공급자 구현
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
author: Xansky
ms.author: mhopkins
ms.openlocfilehash: 270267fa961e2d9420364bc11992be9eff03866b
ms.sourcegitcommit: 213292dfbb0c37d83f62709959ff55c50af5560d
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/25/2018
ms.locfileid: "47113925"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="21873-102">서버 쪽 UI 자동화 공급자 구현</span><span class="sxs-lookup"><span data-stu-id="21873-102">Server-Side UI Automation Provider Implementation</span></span>
> [!NOTE]
>  <span data-ttu-id="21873-103">이 설명서는 <xref:System.Windows.Automation> 네임스페이스에 정의된 관리되는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 클래스를 사용하려는 .NET Framework 개발자를 위한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="21873-104">에 대 한 최신 정보에 대 한 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]를 참조 하세요 [Windows Automation API: UI 자동화](https://go.microsoft.com/fwlink/?LinkID=156746)합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="21873-105">이 섹션에서는 사용자 지정 컨트롤에 대한 서버 쪽 UI 자동화 공급자를 구현하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-105">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>  
  
 <span data-ttu-id="21873-106">Windows Presentation Foundation (WPF) 요소에 대 한 및 비 구현-[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 요소 (위해 설계 된 것과 같은 [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) 근본적으로 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="21873-106">The implementation for Windows Presentation Foundation (WPF) elements and non-[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] elements (such as those designed for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) is fundamentally different.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="21873-107"> 요소는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에서 파생 클래스를 통해 <xref:System.Windows.Automation.Peers.AutomationPeer>에 대해 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-107"> elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="21873-108">비[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 요소는 공급자 인터페이스의 구현을 통해 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-108">Non-[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] elements provide support through implementations of provider interfaces.</span></span>  
  
<a name="Security_Considerations"></a>   
## <a name="security-considerations"></a><span data-ttu-id="21873-109">보안 고려 사항</span><span class="sxs-lookup"><span data-stu-id="21873-109">Security Considerations</span></span>  
 <span data-ttu-id="21873-110">부분적 신뢰 환경에서 작동할 수 있도록 공급자를 작성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-110">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="21873-111">UIAutomationClient.dll은 부분적 신뢰 환경에서 실행되도록 구성되지 않았으므로, 공급자 코드가 해당 어셈블리를 참조해서는 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-111">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="21873-112">참조하는 경우에는 이 코드를 완전 신뢰 환경에서 실행할 수 있지만 부분적 신뢰 환경에서 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-112">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>  
  
 <span data-ttu-id="21873-113">특히 UIAutomationClient.dll의 클래스에서 가져온 필드(예: <xref:System.Windows.Automation.AutomationElement>의 필드)를 사용하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-113">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="21873-114">대신, UIAutomationTypes.dll의 클래스(예: <xref:System.Windows.Automation.AutomationElementIdentifiers>)에서 가져온 해당 필드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-114">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>  
  
<a name="Provider_Implementation_by_WPF_Elements"></a>   
## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="21873-115">Windows Presentation Foundation 요소를 사용한 공급자 구현</span><span class="sxs-lookup"><span data-stu-id="21873-115">Provider Implementation by Windows Presentation Foundation Elements</span></span>  
 <span data-ttu-id="21873-116">이 항목에 대한 자세한 내용은 [WPF 사용자 지정 컨트롤의 UI 자동화](../../../docs/framework/wpf/controls/ui-automation-of-a-wpf-custom-control.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="21873-116">For more information on this topic, please see [UI Automation of a WPF Custom Control](../../../docs/framework/wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>  
  
<a name="Provider_Implementation_by_non_WPF_Elements"></a>   
## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="21873-117">비 WPF 요소를 사용한 공급자 구현</span><span class="sxs-lookup"><span data-stu-id="21873-117">Provider Implementation by non-WPF Elements</span></span>  
 <span data-ttu-id="21873-118">[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] 프레임워크의 일부가 아니지만 관리 코드로 작성된 사용자 지정 컨트롤(대부분의 경우 [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] 컨트롤)은 인터페이스를 구현하여 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에 대해 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-118">Custom controls that are not part of the [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] framework, but that are written in managed code (most often these are [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="21873-119">모든 요소는 다음 섹션의 첫 번째 표에 나온 인터페이스 중 하나 이상을 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-119">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="21873-120">또한 요소가 하나 이상의 컨트롤 패턴을 지원하는 경우 각 컨트롤 패턴에 대해 적절한 인터페이스를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-120">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>  
  
 <span data-ttu-id="21873-121">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 공급자 프로젝트는 다음 어셈블리를 참조해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-121">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>  
  
-   <span data-ttu-id="21873-122">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="21873-122">UIAutomationProviders.dll</span></span>  
  
-   <span data-ttu-id="21873-123">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="21873-123">UIAutomationTypes.dll</span></span>  
  
-   <span data-ttu-id="21873-124">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="21873-124">WindowsBase.dll</span></span>  
  
  
<a name="Provider_Interfaces"></a>   
### <a name="provider-interfaces"></a><span data-ttu-id="21873-125">공급자 인터페이스</span><span class="sxs-lookup"><span data-stu-id="21873-125">Provider Interfaces</span></span>  
 <span data-ttu-id="21873-126">모든 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 공급자는 다음 인터페이스 중 하나를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-126">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>  
  
|<span data-ttu-id="21873-127">인터페이스</span><span class="sxs-lookup"><span data-stu-id="21873-127">Interface</span></span>|<span data-ttu-id="21873-128">설명</span><span class="sxs-lookup"><span data-stu-id="21873-128">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="21873-129">컨트롤 패턴 및 속성에 대한 지원을 포함하여 창에서 호스트되는 간단한 제어용 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-129">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|  
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="21873-130"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple>에서 상속됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-130">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="21873-131">조각 내의 탐색, 포커스 설정, 요소의 경계 사각형 반환 등을 포함하여 복잡한 제어에 있는 요소에 대한 기능을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-131">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|  
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="21873-132"><xref:System.Windows.Automation.Provider.IRawElementProviderFragment>에서 상속됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="21873-133">지정된 좌표에 자식 요소 배치, 전체 컨트롤에 대한 포커스 상태 설정을 포함하여 복잡한 제어에 있는 루트 요소에 대한 기능을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-133">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|  
  
 <span data-ttu-id="21873-134">다음 인터페이스는 추가된 기능을 제공하지만 반드시 구현할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-134">The following interfaces provide added functionality but are not required to be implemented.</span></span>  
  
|<span data-ttu-id="21873-135">인터페이스</span><span class="sxs-lookup"><span data-stu-id="21873-135">Interface</span></span>|<span data-ttu-id="21873-136">설명</span><span class="sxs-lookup"><span data-stu-id="21873-136">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="21873-137">공급자가 이벤트에 대한 요청을 추적할 수 있게 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-137">Enables the provider to track requests for events.</span></span>|  
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="21873-138">조각의 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리 내에서 창 기반 요소의 위치 변경을 가능하게 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-138">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|  
  
 <span data-ttu-id="21873-139"><xref:System.Windows.Automation.Provider> 네임스페이스의 다른 모든 인터페이스는 컨트롤 패턴을 지원하는 용도입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-139">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>  
  
<a name="Requirements_for_Non_WPF_Providers"></a>   
### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="21873-140">비 WPF 공급자에 대한 요구 사항</span><span class="sxs-lookup"><span data-stu-id="21873-140">Requirements for Non-WPF Providers</span></span>  
 <span data-ttu-id="21873-141">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]와 통신하려면 컨트롤이 다음과 같은 주요 기능 영역을 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-141">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>  
  
|<span data-ttu-id="21873-142">기능</span><span class="sxs-lookup"><span data-stu-id="21873-142">Functionality</span></span>|<span data-ttu-id="21873-143">구현</span><span class="sxs-lookup"><span data-stu-id="21873-143">Implementation</span></span>|  
|-------------------|--------------------|  
|<span data-ttu-id="21873-144">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="21873-144">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="21873-145">제어 창에 전송된 WM_GETOBJECT 메시지에 대한 응답으로, <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> 을 구현하는 개체(또는 파생된 인터페이스)를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-145">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="21873-146">조각의 경우, 이는 조각 루트에 대한 공급자여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-146">For fragments, this must be the provider for the fragment root.</span></span>|  
|<span data-ttu-id="21873-147">속성 값 제공</span><span class="sxs-lookup"><span data-stu-id="21873-147">Provide property values</span></span>|<span data-ttu-id="21873-148"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> 를 구현하여 값을 제공하거나 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-148">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|  
|<span data-ttu-id="21873-149">클라이언트에서 컨트롤을 조작할 수 있게 설정</span><span class="sxs-lookup"><span data-stu-id="21873-149">Enable the client to interact with the control</span></span>|<span data-ttu-id="21873-150"><xref:System.Windows.Automation.Provider.IInvokeProvider>와 같은 컨트롤 패턴을 지원하는 인터페이스를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-150">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="21873-151">이러한 패턴 공급자를 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>구현에서 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-151">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|  
|<span data-ttu-id="21873-152">이벤트 발생</span><span class="sxs-lookup"><span data-stu-id="21873-152">Raise events</span></span>|<span data-ttu-id="21873-153"><xref:System.Windows.Automation.Provider.AutomationInteropProvider> 의 정적 메서드 중 하나를 호출하여 클라이언트가 수신할 수 있는 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="21873-153">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|  
|<span data-ttu-id="21873-154">조각 내에서 탐색 및 포커스를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-154">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="21873-155">조각 내의 각 요소에 대해 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> 를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-155">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="21873-156">(조각의 포함되지 않은 요소의 경우 필요 없습니다.)</span><span class="sxs-lookup"><span data-stu-id="21873-156">(Not necessary for elements that are not part of a fragment.)</span></span>|  
|<span data-ttu-id="21873-157">조각 내 자식 요소의 포커스 및 위치를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-157">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="21873-158"><xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-158">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="21873-159">(조각 루트가 아닌 요소의 경우 필요 없습니다.)</span><span class="sxs-lookup"><span data-stu-id="21873-159">(Not necessary for elements that are not fragment roots.)</span></span>|  
  
<a name="Property_Values_in_Non_WPF_Providers"></a>   
### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="21873-160">비 WPF 공급자의 속성 값</span><span class="sxs-lookup"><span data-stu-id="21873-160">Property Values in Non-WPF Providers</span></span>  
 <span data-ttu-id="21873-161">사용자 지정 컨트롤에 대한[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 공급자는 자동화 시스템뿐만 아니라 클라이언트 응용 프로그램에서도 사용할 수 있는 특정 속성을 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-161">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="21873-162">창에서 호스트되는 요소(HWND)의 경우 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에서는 기본 창 공급자에서 일부 속성을 검색할 수 있지만 다른 일부 속성은 사용자 지정 공급자에서 가져와야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-162">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>  
  
 <span data-ttu-id="21873-163">HWND 기반 컨트롤에 대한 공급자는 일반적으로 다음 속성(필드 값으로 식별됨)을 제공할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-163">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>  
  
-   <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>  
  
> [!NOTE]
>  <span data-ttu-id="21873-164">간단한 요소나 창에서 호스트되는 조각 루트의 <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> 는 창에서 가져옵니다. 그러나 루트 아래의 조각 요소(예: 목록 상자에 있는 목록 항목)는 고유 식별자를 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-164">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="21873-165">자세한 내용은 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="21873-165">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>  
>   
>  <span data-ttu-id="21873-166"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> 컨트롤에서 호스트되는 공급자에 대해 [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] 를 반환해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] control.</span></span> <span data-ttu-id="21873-167">이 경우 기본 창 공급자가 올바른 값을 검색하지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-167">In this case, the default window provider may be unable to retrieve the correct value.</span></span>  
>   
>  <span data-ttu-id="21873-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> 는 일반적으로 호스트 공급자가 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="21873-169">예를 들어 사용자 지정 컨트롤이 <xref:System.Windows.Forms.Control>에서 파생된 경우 이름은 컨트롤의 `Text` 속성에서 파생됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-169">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>  
  
 <span data-ttu-id="21873-170">예제 코드를 보려면 [Return Properties from a UI Automation Provider](../../../docs/framework/ui-automation/return-properties-from-a-ui-automation-provider.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="21873-170">For example code, see [Return Properties from a UI Automation Provider](../../../docs/framework/ui-automation/return-properties-from-a-ui-automation-provider.md).</span></span>  
  
<a name="Events_in_Non_WPF_Providers"></a>   
### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="21873-171">비 WPF 공급자의 이벤트</span><span class="sxs-lookup"><span data-stu-id="21873-171">Events in Non-WPF Providers</span></span>  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="21873-172"> 공급자는 UI 상태 변경 시 이를 클라이언트 응용 프로그램에 알리는 이벤트를 발생시켜야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-172"> providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="21873-173">다음 메서드는 이벤트를 발생시키는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-173">The following methods are used to raise events.</span></span>  
  
|<span data-ttu-id="21873-174">메서드</span><span class="sxs-lookup"><span data-stu-id="21873-174">Method</span></span>|<span data-ttu-id="21873-175">설명</span><span class="sxs-lookup"><span data-stu-id="21873-175">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="21873-176">컨트롤 패턴에 의해 트리거되는 이벤트를 포함하여 다양한 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="21873-176">Raises various events, including events triggered by control patterns.</span></span>|  
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="21873-177">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 속성이 변경되면 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="21873-177">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|  
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="21873-178">예를 들어 요소가 제거되거나 추가되는 등, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리가 변경되면 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="21873-178">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|  
  
 <span data-ttu-id="21873-179">이벤트의 목적은 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]에서 발생하는 상황과 이 활동이 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 시스템 자체에서 트리거되는지 여부를 클라이언트에 알리는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-179">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="21873-180">예를 들어 <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> 로 식별되는 이벤트는 직접적인 사용자 입력을 통해서든 아니면 클라이언트 응용 프로그램이 <xref:System.Windows.Automation.InvokePattern.Invoke%2A>를 호출해서든 상관없이 컨트롤이 호출될 때마다 발생해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-180">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>  
  
 <span data-ttu-id="21873-181">성능을 최적화하기 위해 공급자는 선택적으로 이벤트를 발생시키거나 이벤트 수신을 등록한 클라이언트 응용 프로그램이 없는 경우에는 이벤트를 전혀 발생시키지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-181">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="21873-182">최적화를 위해 다음 메서드가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-182">The following methods are used for optimization.</span></span>  
  
|<span data-ttu-id="21873-183">메서드</span><span class="sxs-lookup"><span data-stu-id="21873-183">Method</span></span>|<span data-ttu-id="21873-184">설명</span><span class="sxs-lookup"><span data-stu-id="21873-184">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="21873-185">이 정적 속성은 클라이언트 응용 프로그램이 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 이벤트를 수신하도록 가입했는지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-185">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|  
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="21873-186">공급자가 조각 루트에 대해 이 인터페이스를 구현하면 클라이언트가 조각의 이벤트에 대해 이벤트 처리기를 등록하거나 등록 취소할 때 이에 대해 알림을 받을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-186">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|  
  
<a name="Non_WPF_Provider_Navigation"></a>   
### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="21873-187">비 WPF 공급자 탐색</span><span class="sxs-lookup"><span data-stu-id="21873-187">Non-WPF Provider Navigation</span></span>  
 <span data-ttu-id="21873-188">창에서 호스트되는 사용자 지정 단추(HWND)와 같은 간단한 컨트롤의 공급자는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리 내의 탐색을 지원할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-188">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="21873-189">요소 및 요소 간 탐색은 호스트 창에 대한 기본 공급자가 처리하며, 이에 대해서는 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>구현에서 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-189">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="21873-190">그러나 복잡한 사용자 지정 제어를 위한 공급자를 구현하는 경우에는 조각의 루트 노드와 해당 하위 항목 사이, 그리고 형제 노드 사이의 탐색을 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-190">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="21873-191">루트 이외의 조각 요소는 창에서 직접 호스트되지 않으며 기본 공급자가 이 요소에 대한 탐색을 지원할 수 없기 때문에 `null` 에서 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>참조를 반환해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-191">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>  
  
 <span data-ttu-id="21873-192">조각의 구조는 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>의 구현에 따라 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-192">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="21873-193">각 조각에서 가능한 각 방향에 대해, 이 메서드는 해당 방향에 있는 요소에 대한 공급자 개체를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-193">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="21873-194">해당 방향에 요소가 없는 경우 메서드는 `null` 참조를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-194">If there is no element in that direction, the method returns a `null` reference.</span></span>  
  
 <span data-ttu-id="21873-195">조각 루트는 자식 요소에 대해서만 탐색을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-195">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="21873-196">예를 들어 방향이 <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>이면 목록 상자는 목록의 첫 번째 항목을 반환하고 방향이 <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>이면 마지막 항목을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-196">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="21873-197">조각 루트는 부모 또는 형제 항목 탐색을 지원하지 않습니다. 이 작업은 호스트 창 공급자에 의해 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="21873-197">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>  
  
 <span data-ttu-id="21873-198">조각의 루트가 아닌 요소는 부모뿐만 아니라 해당 형제 및 자식 항목에 대해서도 탐색을 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-198">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>  
  
<a name="Non_WPF_Provider_Reparenting"></a>   
### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="21873-199">비 WPF 공급자 부모 재지정</span><span class="sxs-lookup"><span data-stu-id="21873-199">Non-WPF Provider Reparenting</span></span>  
 <span data-ttu-id="21873-200">팝업 창은 실제로 최상위 창이므로 기본적으로 데스크톱의 자식 항목으로 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리에 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="21873-200">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="21873-201">그러나 많은 경우, 팝업 창은 논리적으로 다른 일부 컨트롤의 자식 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-201">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="21873-202">예를 들어 콤보 상자의 드롭다운 목록은 논리적으로 콤보 상자의 자식 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-202">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="21873-203">마찬가지로, 메뉴 팝업 창은 논리적으로 메뉴의 자식 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-203">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="21873-204"> 에서는 팝업 창이 관련 컨트롤의 자식 항목으로 보이도록 팝업 창의 부모 재지정을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-204"> provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>  
  
 <span data-ttu-id="21873-205">팝업 창의 부모를 다시 지정하려면</span><span class="sxs-lookup"><span data-stu-id="21873-205">To reparent a pop-up window:</span></span>  
  
1.  <span data-ttu-id="21873-206">팝업 창에 대한 공급자를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="21873-206">Create a provider for the pop-up window.</span></span> <span data-ttu-id="21873-207">그러려면 팝업 창의 클래스를 미리 알고 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-207">This requires that the class of the pop-up window is known in advance.</span></span>  
  
2.  <span data-ttu-id="21873-208">해당 팝업에 대해 평소와 같이, 고유 권한이 있는 컨트롤처럼 모든 속성과 패턴을 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-208">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>  
  
3.  <span data-ttu-id="21873-209"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> 에서 가져온 값을 반환하도록 <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>속성을 구현합니다. 여기서 매개 변수는 팝업 창의 창 핸들입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-209">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>  
  
4.  <span data-ttu-id="21873-210">논리 부모에서 논리 자식으로, 그리고 형제 자식 사이에 탐색이 올바르게 처리되도록 팝업 창 및 해당 상위 항목에 대해 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> 을 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-210">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>  
  
 <span data-ttu-id="21873-211">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]에서 팝업 창을 발견하면 탐색이 기본값에서 재정의된다는 것을 인식하며 데스크톱의 자식 항목으로 발견된 경우에는 팝업 창으로 건너뜁니다.</span><span class="sxs-lookup"><span data-stu-id="21873-211">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="21873-212">대신, 조각을 통해서만 노드에 도달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-212">Instead, the node will only be reachable through the fragment.</span></span>  
  
 <span data-ttu-id="21873-213">부모 재지정은 컨트롤이 클래스의 창을 호스트할 수 있는 경우에는 적합하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-213">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="21873-214">예를 들어 rebar는 모든 유형의 HWND를 밴드에서 호스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-214">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="21873-215">이런 경우를 처리하기 위해 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에서는 다음 섹션의 설명대로 다른 형식의 HWND 재배치를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-215">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>  
  
<a name="Non_WPF_Provider_Repositioning"></a>   
### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="21873-216">비 WPF 공급자 위치 변경</span><span class="sxs-lookup"><span data-stu-id="21873-216">Non-WPF Provider Repositioning</span></span>  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="21873-217"> 조각은 각각 창에 포함된 두 개 이상의 항목(HWND)을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-217"> fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="21873-218">각 HWND에는 HWND를 이를 포함하는 HWND의 자식으로 간주하는 고유한 기본 공급자가 있기 때문에, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리는 기본적으로 조각에 있는 HWND를 부모 창의 자식 항목으로 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-218">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="21873-219">대부분의 경우 이것은 바람직한 동작이지만, 때로는 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]의 논리 구조와 일치하지 않기 때문에 혼란을 일으킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-219">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
 <span data-ttu-id="21873-220">그 좋은 예가 rebar 컨트롤입니다.</span><span class="sxs-lookup"><span data-stu-id="21873-220">A good example of this is a rebar control.</span></span> <span data-ttu-id="21873-221">rebar에는 밴드가 있고, 각 밴드에는 도구 모음, 편집 상자, 콤보 상자와 같은 HWND 기반 컨트롤이 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-221">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="21873-222">rebar HWND에 대한 기본 창 공급자는 밴드 컨트롤 HWND를 자식으로 간주하고, rebar 공급자는 밴드를 자식으로 간주합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-222">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="21873-223">HWND 공급자 및 rebar 공급자는 함께 작업하며 각 자식 항목을 결합하기 때문에 밴드와 HWND 기반 컨트롤이 모두 rebar의 자식으로 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="21873-223">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="21873-224">그러나 논리적으로는 밴드만 rebar의 자식으로 나타나야 하며 각 밴드 공급자는 포함된 컨트롤에 대한 기본 HWND 공급자와 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-224">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>  
  
 <span data-ttu-id="21873-225">이를 위해 rebar에 대한 조각 루트 공급자는 밴드는 나타내는 일련의 자식 항목을 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-225">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="21873-226">각 밴드에는 속성 및 패턴을 노출할 수 있는 단일 공급자가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="21873-226">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="21873-227"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>구현에서 밴드 공급자는 <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>호출 후 컨트롤의 창 핸들에 전달하여 가져온 컨트롤 HWND에 대한 기본 창 공급자를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-227">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="21873-228">마지막으로, rebar에 대한 조각 루트 공급자는 <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> 인터페이스를 구현하고 <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> 구현에서 지정된 HWND에 포함된 컨트롤에 적절한 밴드 공급자를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="21873-228">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="21873-229">참고 항목</span><span class="sxs-lookup"><span data-stu-id="21873-229">See Also</span></span>  
 [<span data-ttu-id="21873-230">UI 자동화 공급자 개요</span><span class="sxs-lookup"><span data-stu-id="21873-230">UI Automation Providers Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-providers-overview.md)  
 [<span data-ttu-id="21873-231">서버 쪽 UI 자동화 공급자 노출</span><span class="sxs-lookup"><span data-stu-id="21873-231">Expose a Server-side UI Automation Provider</span></span>](../../../docs/framework/ui-automation/expose-a-server-side-ui-automation-provider.md)  
 [<span data-ttu-id="21873-232">UI 자동화 공급자에서 속성 반환</span><span class="sxs-lookup"><span data-stu-id="21873-232">Return Properties from a UI Automation Provider</span></span>](../../../docs/framework/ui-automation/return-properties-from-a-ui-automation-provider.md)  
 [<span data-ttu-id="21873-233">UI 자동화 공급자에서 이벤트 발생</span><span class="sxs-lookup"><span data-stu-id="21873-233">Raise Events from a UI Automation Provider</span></span>](../../../docs/framework/ui-automation/raise-events-from-a-ui-automation-provider.md)  
 [<span data-ttu-id="21873-234">UI 자동화 조각 공급자에서 탐색 사용</span><span class="sxs-lookup"><span data-stu-id="21873-234">Enable Navigation in a UI Automation Fragment Provider</span></span>](../../../docs/framework/ui-automation/enable-navigation-in-a-ui-automation-fragment-provider.md)  
 [<span data-ttu-id="21873-235">UI 자동화 공급자의 컨트롤 패턴 지원</span><span class="sxs-lookup"><span data-stu-id="21873-235">Support Control Patterns in a UI Automation Provider</span></span>](../../../docs/framework/ui-automation/support-control-patterns-in-a-ui-automation-provider.md)  
 [<span data-ttu-id="21873-236">단순 공급자 샘플</span><span class="sxs-lookup"><span data-stu-id="21873-236">Simple Provider Sample</span></span>](https://msdn.microsoft.com/library/c10a6255-e8dc-494b-a051-15111b47984a)  
 [<span data-ttu-id="21873-237">조각 공급자 샘플</span><span class="sxs-lookup"><span data-stu-id="21873-237">Fragment Provider Sample</span></span>](https://msdn.microsoft.com/library/778ef1bc-8610-4bc9-886e-aeff94a8a13e)
