---
title: Windows Forms 및 관리되지 않는 애플리케이션 개요
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 63631378911a9ba95713e68fb19d8d08176c7562
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61748178"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="866d2-102">Windows Forms 및 관리되지 않는 애플리케이션 개요</span><span class="sxs-lookup"><span data-stu-id="866d2-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="866d2-103">Windows Forms 애플리케이션과 컨트롤은 관리되지 않는 애플리케이션과 상호 운용될 수 있지만 몇 가지 주의할 사항이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="866d2-104">다음 섹션에서는 Windows Forms 애플리케이션과 컨트롤이 지원하는 시나리오 및 구성과 지원하지 않는 시나리오 및 구성을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="866d2-105">Windows Forms 컨트롤 및 ActiveX 애플리케이션</span><span class="sxs-lookup"><span data-stu-id="866d2-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="866d2-106">Microsoft Internet Explorer 및 MFC(Microsoft Foundation Classes)를 제외하고 Windows Forms 컨트롤은 ActiveX 컨트롤을 호스트하도록 설계된 애플리케이션에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="866d2-107">Visual Studio .NET 2003 이전 Visual Studio 버전의 ActiveX 테스트 컨테이너를 포함하여 ActiveX 컨트롤을 호스트할 수 있는 다른 애플리케이션과 개발 도구는 Windows Forms 컨트롤에 대해 지원되는 호스트가 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="866d2-108">이러한 제약 조건은 COM(구성 요소 개체 모델) interop를 통한 Windows Forms 컨트롤 사용에도 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="866d2-109">CCW(COM 호출 가능 래퍼)를 통한 Windows Forms 컨트롤 사용은 Internet Explorer에서만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="866d2-110">COM interop에 대한 자세한 내용은</span><span class="sxs-lookup"><span data-stu-id="866d2-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="866d2-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="866d2-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="866d2-112">다음 표에서는 Windows Forms 컨트롤에 사용할 수 있는 ActiveX 호스팅 지원을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="866d2-113">Windows Forms 버전</span><span class="sxs-lookup"><span data-stu-id="866d2-113">Windows Forms version</span></span>|<span data-ttu-id="866d2-114">지원</span><span class="sxs-lookup"><span data-stu-id="866d2-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="866d2-115">.NET Framework 버전 1.0</span><span class="sxs-lookup"><span data-stu-id="866d2-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="866d2-116">Internet Explorer 5.01 이상 버전</span><span class="sxs-lookup"><span data-stu-id="866d2-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="866d2-117">.NET Framework 버전 1.1 이상</span><span class="sxs-lookup"><span data-stu-id="866d2-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="866d2-118">Internet Explorer 5.01 이상 버전</span><span class="sxs-lookup"><span data-stu-id="866d2-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="866d2-119">MFC(Microsoft Foundation Classes) 7.0 이상</span><span class="sxs-lookup"><span data-stu-id="866d2-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="866d2-120">ActiveX 컨트롤로 Windows Forms 구성 요소 호스트</span><span class="sxs-lookup"><span data-stu-id="866d2-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="866d2-121">.NET Framework 1.1에서는 MFC 7.0 이상 버전을 포함하도록 지원이 확장되었습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="866d2-122">이 지원에는 MFC 7.0 이상 ActiveX 컨트롤 컨테이너와 완전히 호환되는 모든 컨테이너가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="866d2-123">그러나 Windows Forms 컨트롤을 ActiveX 컨트롤로 등록하는 기능은 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="866d2-124">또한 Windows Forms 컨트롤에 대한 `com.ms.win32.Ole32.CoCreateInstance` 메서도 호출도 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="866d2-125">Windows Forms 컨트롤의 관리되는 활성화만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="866d2-126">Windows Forms 컨트롤을 만든 후에 ActiveX 컨트롤과 마찬가지로 MFC 애플리케이션에서 호스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="866d2-127">관리되지 않는 애플리케이션에서 Windows Forms 컨트롤을 사용하려면 관리되지 않는 CLR 호스팅 API로 CLR을 호스트하거나 C++ interop 기능을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="866d2-128">C++ interop 기능 사용이 권장 솔루션입니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="866d2-129">COM 클라이언트 애플리케이션의 Windows Forms</span><span class="sxs-lookup"><span data-stu-id="866d2-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="866d2-130">Visual Basic 6.0 애플리케이션이나 MFC 애플리케이션과 같은 COM 클라이언트 애플리케이션에서 Windows Form을 여는 경우 폼이 예기치 않게 동작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="866d2-131">예를 들어 Tab 키를 누를 때 포커스가 한 컨트롤에서 다른 컨트롤로 변경되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="866d2-132">명령 단추에 포커스가 있는 동안 Enter 키를 누를 때 단추의 <xref:System.Windows.Forms.Control.Click> 이벤트가 발생하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="866d2-133">키 입력이나 마우스 활동에 대한 예기치 않은 동작이 발생할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="866d2-134">이 동작은 관리되지 않는 애플리케이션에서 Windows Forms이 제대로 작동하는 데 필요한 메시지 루프 지원을 구현하지 않기 때문에 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="866d2-135">COM 클라이언트 애플리케이션에서 제공하는 메시지 루프는 기본적으로 Windows Forms 메시지 루프와 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="866d2-136">애플리케이션의 메시지 루프는 스레드의 메시지 큐에서 메시지를 검색하고 변환한 다음 처리되도록 애플리케이션에 보내는 내부 프로그램 루프입니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="866d2-137">Windows Form의 메시지 루프에는 Visual Basic 6.0 애플리케이션 및 MFC 애플리케이션과 같은 이전 애플리케이션이 제공하는 메시지 루프와 동일한 아키텍처가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="866d2-138">메시지 루프에 게시된 창 메시지가 Windows Form의 예상과 다르게 처리될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="866d2-139">따라서 예기치 않은 동작이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="866d2-140">일부 키 입력 조합이 작동하지 않거나, 일부 마우스 활동이 작동하지 않거나, 일부 이벤트가 예상대로 발생하지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="866d2-141">상호 운용성 문제 해결</span><span class="sxs-lookup"><span data-stu-id="866d2-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="866d2-142"><xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> 메서드를 사용하여 만든 폼을 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 메시지 루프에 표시하여 이러한 문제를 해결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-142">You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="866d2-143">Windows Form이 COM 클라이언트 애플리케이션에서 제대로 작동하게 하려면 Windows Forms 메시지 루프에서 실행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="866d2-144">이렇게 하려면 다음 접근 방식 중 하나를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-144">To do this, use one of the following approaches:</span></span>  
  
- <span data-ttu-id="866d2-145"><xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> 메서드를 사용하여 Windows Form을 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="866d2-146">자세한 내용은 [방법: ShowDialog 메서드로 Windows Form을 표시 하 여 COM Interop 지원](com-interop-by-displaying-a-windows-form-shadow.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
- <span data-ttu-id="866d2-147">각 Windows Form을 새 스레드에 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="866d2-148">자세한 내용은 [방법: 각 Windows Form을 별개의 스레드에서 표시 하 여 COM Interop 지원](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="866d2-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="866d2-149">참고자료</span><span class="sxs-lookup"><span data-stu-id="866d2-149">See also</span></span>

- [<span data-ttu-id="866d2-150">Windows Forms 및 관리되지 않는 응용 프로그램</span><span class="sxs-lookup"><span data-stu-id="866d2-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="866d2-151">COM Interop</span><span class="sxs-lookup"><span data-stu-id="866d2-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="866d2-152">.NET Framework 응용 프로그램의 COM 상호 운용성</span><span class="sxs-lookup"><span data-stu-id="866d2-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="866d2-153">[COM 상호 운용성 샘플](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="866d2-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="866d2-154">Aximp.exe(Windows Forms ActiveX 컨트롤 가져오기)</span><span class="sxs-lookup"><span data-stu-id="866d2-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="866d2-155">.NET Framework 구성 요소를 COM에 노출</span><span class="sxs-lookup"><span data-stu-id="866d2-155">Exposing .NET Framework Components to COM</span></span>](../../interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="866d2-156">COM에서 사용할 어셈블리의 패키징</span><span class="sxs-lookup"><span data-stu-id="866d2-156">Packaging an Assembly for COM</span></span>](../../interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="866d2-157">COM에 어셈블리 등록</span><span class="sxs-lookup"><span data-stu-id="866d2-157">Registering Assemblies with COM</span></span>](../../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="866d2-158">방법: ShowDialog 메서드로 Windows Form을 표시 하 여 COM Interop 지원</span><span class="sxs-lookup"><span data-stu-id="866d2-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="866d2-159">방법: 각 Windows Form을 별개의 스레드에서 표시 하 여 COM Interop 지원</span><span class="sxs-lookup"><span data-stu-id="866d2-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
