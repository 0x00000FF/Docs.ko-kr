---
title: WSFederation 인증 모듈 개요
ms.date: 03/30/2017
ms.assetid: 02c4d5e8-f0a7-49ee-9cf5-3647578510ad
author: BrucePerlerMS
ms.openlocfilehash: f4dc63272c47dc0cd9eaa15986e4369d9d689b64
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64592361"
---
# <a name="wsfederation-authentication-module-overview"></a><span data-ttu-id="7ff20-102">WSFederation 인증 모듈 개요</span><span class="sxs-lookup"><span data-stu-id="7ff20-102">WSFederation Authentication Module Overview</span></span>
<span data-ttu-id="7ff20-103">WIF(Windows Identity Foundation)에는 WS-FAM( WS-Federated Authentication Module)을 통한 ASP.NET 애플리케이션의 페더레이션된 인증 지원이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-103">Windows Identity Foundation (WIF) includes support for federated authentication in ASP.NET applications through the WS-Federated Authentication Module (WS-FAM).</span></span> <span data-ttu-id="7ff20-104">이 항목은 페더레이션된 인증의 작동 방식과 사용 방법을 이해하는 데 도움이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-104">This topic will help you understand how federated authentication works and how to use it.</span></span>  
  
### <a name="overview-of-federated-authentication"></a><span data-ttu-id="7ff20-105">페더레이션된 인증 개요</span><span class="sxs-lookup"><span data-stu-id="7ff20-105">Overview of Federated Authentication</span></span>  
 <span data-ttu-id="7ff20-106">페더레이션된 인증을 사용하면 두 도메인 간에 트러스트 관계가 있는 경우 한 트러스트 도메인의 STS(보안 토큰 서비스)에서 다른 트러스트 도메인의 STS에 인증 정보를 제공할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-106">Federated authentication allows a Security Token Service (STS) in one trust domain to provide authentication information to an STS in another trust domain when there is a trust relationship between the two domains.</span></span> <span data-ttu-id="7ff20-107">이 예제는 다음 그림에 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-107">An example of this is shown in the following illustration:</span></span>  
  
 ![페더레이션된 인증 시나리오를 보여 주는 다이어그램입니다.](./media/wsfederation-authentication-module-overview/federated-authentication.gif)  
  
1. <span data-ttu-id="7ff20-109">Fabrikam 트러스트 도메인의 클라이언트는 Contoso 트러스트 도메인의 RP(신뢰 당사자) 애플리케이션에 요청을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-109">A client in the Fabrikam trust domain sends a request to a Relying Party (RP) application in the Contoso trust domain.</span></span>  
  
2. <span data-ttu-id="7ff20-110">RP는 클라이언트를 Contoso 트러스트 도메인의 STS로 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-110">The RP redirects the client to an STS in the Contoso trust domain.</span></span> <span data-ttu-id="7ff20-111">이 STS는 클라이언트를 알지 못합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-111">This STS has no knowledge of the client.</span></span>  
  
3. <span data-ttu-id="7ff20-112">Contoso STS는 Contoso 트러스트 도메인과 트러스트 관계가 있는 Fabrikam 트러스트 도메인의 STS에 클라이언트를 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-112">The Contoso STS redirects the client to an STS in the Fabrikam trust domain, with which the Contoso trust domain has a trust relationship.</span></span>  
  
4. <span data-ttu-id="7ff20-113">Fabrikam STS는 클라이언트의 ID를 확인하고 Contoso STS에 보안 토큰을 발급합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-113">The Fabrikam STS verifies the client’s identity and issues a security token to the Contoso STS.</span></span>  
  
5. <span data-ttu-id="7ff20-114">Contoso STS는 Fabrikam 토큰을 사용하여 RP에서 사용할 수 있는 자체 토큰을 만들어 RP에 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-114">The Contoso STS uses the Fabrikam token to create its own token that can be used by the RP and sends it to the RP.</span></span>  
  
6. <span data-ttu-id="7ff20-115">RP는 보안 토큰에서 클라이언트의 클레임을 추출하고 권한 부여를 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-115">The RP extracts the client’s claims from the security token and makes an authorization decision.</span></span>  
  
### <a name="using-the-federated-authentication-module-with-aspnet"></a><span data-ttu-id="7ff20-116">ASP.NET과 함께 페더레이션된 인증 모듈 사용</span><span class="sxs-lookup"><span data-stu-id="7ff20-116">Using the Federated Authentication Module with ASP.NET</span></span>  
 <span data-ttu-id="7ff20-117"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule>(WS-FAM)은 [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] 응용 프로그램에 페더레이션된 인증을 추가할 수 있는 HTTP 모듈입니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-117"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule> (WS-FAM) is an HTTP module that lets you add federated authentication to an [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] application.</span></span> <span data-ttu-id="7ff20-118">페더레이션된 인증을 사용하면 STS를 통해 인증 논리를 처리하고 비즈니스 논리 작성에 집중할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-118">Federated authentication lets authentication logic be handled by the STS and lets you focus on writing business logic.</span></span>  
  
 <span data-ttu-id="7ff20-119">인증되지 않은 요청을 리디렉션할 STS를 지정하려면 WS-FAM을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-119">You configure the WS-FAM to specify the STS to which non-authenticated requests should be redirected.</span></span> <span data-ttu-id="7ff20-120">WIF에서는 다음 두 가지 방법으로 사용자를 인증할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-120">WIF lets you authenticate a user in two ways:</span></span>  
  
1. <span data-ttu-id="7ff20-121">수동 리디렉션: 인증 되지 않은 사용자가 보호 된 리소스에 액세스 하려고 하 고 단순히 로그인 페이지 없이 STS로 리디렉션하 하려는 경우 이것이 올바른 접근 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-121">Passive redirect: When an unauthenticated user tries to access a protected resource, and you want to simply redirect them to an STS without requiring a login page, then this is the right approach.</span></span> <span data-ttu-id="7ff20-122">STS는 사용자의 ID를 확인하고 해당 사용자에 대한 적절한 클레임을 포함하는 보안 토큰을 발급합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-122">The STS verifies the user’s identity, and issues a security token that contains the appropriate claims for that user.</span></span> <span data-ttu-id="7ff20-123">이 옵션을 사용할 경우 HTTP 모듈 파이프라인에 WS-FAM을 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-123">This option requires the WS-FAM to be added in the HTTP Modules pipeline.</span></span> <span data-ttu-id="7ff20-124">Visual Studio 2012용 ID 및 액세스 도구를 통해 WS-FAM을 사용하고 STS와 페더레이션하도록 애플리케이션의 구성 파일을 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-124">You can use the Identity and Access Tool for Visual Studio 2012 to modify your application’s configuration file to use the WS-FAM and to federate with an STS.</span></span> <span data-ttu-id="7ff20-125">자세한 내용은 [Visual Studio 2012용 ID 및 액세스 도구](../../../docs/framework/security/identity-and-access-tool-for-vs.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7ff20-125">For more information, see [Identity and Access Tool for Visual Studio 2012](../../../docs/framework/security/identity-and-access-tool-for-vs.md).</span></span>  
  
2. <span data-ttu-id="7ff20-126">RP 애플리케이션의 로그인 페이지에 대한 코드 숨김에서 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignIn%2A?displayProperty=nameWithType> 메서드 또는 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectToIdentityProvider%2A> 메서드를 호출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-126">You can call the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignIn%2A?displayProperty=nameWithType> method or the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectToIdentityProvider%2A> method from the code-behind for a sign-in page in your RP application.</span></span>  
  
 <span data-ttu-id="7ff20-127">수동 리디렉션에서는 모든 통신이 클라이언트(일반적으로 브라우저)의 응답/리디렉션을 통해 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-127">In passive redirect, all communication is performed through response/redirect from the client (typically a browser).</span></span> <span data-ttu-id="7ff20-128">애플리케이션의 HTTP 파이프라인에 WS-FAM을 추가할 수 있습니다. 여기서 인증되지 않은 사용자 요청을 감시하고 사용자를 지정한 STS로 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-128">You can add the WS-FAM to your application’s HTTP pipeline, where it watches for unauthenticated user requests and redirects users to the STS you specify.</span></span>  
  
 <span data-ttu-id="7ff20-129">WS-FAM은 [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] 애플리케이션에서 해당 기능을 사용자 지정할 수 있게 해주는 여러 이벤트도 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-129">The WS-FAM also raises several events that let you customize its functionality in an [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] application.</span></span>  
  
### <a name="how-the-ws-fam-works"></a><span data-ttu-id="7ff20-130">WS-FAM의 작동 방식</span><span class="sxs-lookup"><span data-stu-id="7ff20-130">How the WS-FAM Works</span></span>  
 <span data-ttu-id="7ff20-131">WS-FAM은 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> 클래스에서 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-131">The WS-FAM is implemented in the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> class.</span></span> <span data-ttu-id="7ff20-132">일반적으로 [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] RP 애플리케이션의 HTTP 파이프라인에 WS-FAM을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-132">Typically, you add the WS-FAM to the HTTP pipeline of your [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] RP application.</span></span> <span data-ttu-id="7ff20-133">인증되지 않은 사용자가 보호된 리소스에 액세스하려고 하면 RP가 “401 인증이 거부되었습니다.”라는 HTTP 응답을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-133">When an unauthenticated user tries to access a protected resource, the RP returns a "401 authorization denied" HTTP response.</span></span> <span data-ttu-id="7ff20-134">WS-FAM은 클라이언트의 수신을 허용하는 대신 이 응답을 가로챈 다음 사용자를 지정된 STS로 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-134">The WS-FAM intercepts this response instead of allowing the client to receive it, then it redirects the user to the specified STS.</span></span> <span data-ttu-id="7ff20-135">STS가 보안 토큰을 발급하고, WS-FAM이 이 토큰을 다시 가로챕니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-135">The STS issues a security token, which the WS-FAM again intercepts.</span></span> <span data-ttu-id="7ff20-136">WS-FAM은 이 토큰을 사용하여 인증된 사용자에 대한 <xref:System.Security.Claims.ClaimsPrincipal> 인스턴스를 만들고, 일반적인 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 권한 부여 메커니즘이 작동할 수 있게 합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-136">The WS-FAM uses the token to create an instance of <xref:System.Security.Claims.ClaimsPrincipal> for the authenticated user, which enables regular [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] authorization mechanisms to function.</span></span>  
  
 <span data-ttu-id="7ff20-137">HTTP는 상태 비저장이므로 사용자가 다른 보호된 리소스에 액세스를 시도할 때마다 이 전체 프로세스를 반복하지 않을 방법이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-137">Because HTTP is stateless, we need a way to avoid repeating this whole process every time that the user tries to access another protected resource.</span></span> <span data-ttu-id="7ff20-138"><xref:System.IdentityModel.Services.SessionAuthenticationModule>이 필요한 이유가 바로 여기에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-138">This is where the <xref:System.IdentityModel.Services.SessionAuthenticationModule> comes in.</span></span> <span data-ttu-id="7ff20-139">STS가 사용자에 대한 보안 토큰을 발급할 때 <xref:System.IdentityModel.Services.SessionAuthenticationModule>에서도 사용자에 대한 세션 보안 토큰을 만들어 쿠키에 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-139">When the STS issues a security token for the user, <xref:System.IdentityModel.Services.SessionAuthenticationModule> also creates a session security token for the user and puts it in a cookie.</span></span> <span data-ttu-id="7ff20-140">후속 요청 시 <xref:System.IdentityModel.Services.SessionAuthenticationModule>은 이 쿠키를 가로챈 다음 사용해서 사용자의 <xref:System.Security.Claims.ClaimsPrincipal>을 다시 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-140">On subsequent requests, the <xref:System.IdentityModel.Services.SessionAuthenticationModule> intercepts this cookie and uses it to reconstruct the user’s <xref:System.Security.Claims.ClaimsPrincipal>.</span></span>  
  
 <span data-ttu-id="7ff20-141">다음 다이어그램은 수동 리디렉션 사례에서 정보의 전반적인 흐름을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-141">The following diagram shows the overall flow of information in the passive redirect case.</span></span> <span data-ttu-id="7ff20-142">STS를 통해 요청이 자동으로 리디렉션되어 로그인 페이지 없이 자격 증명을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-142">The request is automatically redirected via the STS to establish credentials without a login page:</span></span>  
  
 ![수동 리디렉션을 사용한 로그인을 보여 주는 다이어그램입니다.](./media/wsfederation-authentication-module-overview/sign-in-using-passive-redirect.gif)  
  
 <span data-ttu-id="7ff20-144">다음 다이어그램은 사용자가 STS에 인증했으며 해당 보안 토큰이 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule>에 의해 처리될 때 발생하는 사항을 자세히 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-144">The following diagram shows more detail on what happens when the user has authenticated to the STS and their security tokens are processed by the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule>:</span></span>  
  
 <span data-ttu-id="7ff20-145">![수동 리디렉션을 사용한 토큰 처리 타이밍](../../../docs/framework/security/media/signinusingpassiveredirect-tokenprocessing.gif "SignInUsingPassiveRedirect_TokenProcessing")</span><span class="sxs-lookup"><span data-stu-id="7ff20-145">![Timing for token processing with passive redirect](../../../docs/framework/security/media/signinusingpassiveredirect-tokenprocessing.gif "SignInUsingPassiveRedirect_TokenProcessing")</span></span>  
  
 <span data-ttu-id="7ff20-146">다음 다이어그램은 사용자의 보안 토큰이 쿠키로 직렬화되었으며 <xref:System.IdentityModel.Services.SessionAuthenticationModule>에서 가로챌 때 발생하는 사항을 자세히 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-146">The following diagram shows more detail on what happens when the user’s security tokens have been serialized into cookies and are intercepted by the <xref:System.IdentityModel.Services.SessionAuthenticationModule>:</span></span>  
  
 <span data-ttu-id="7ff20-147">![컨트롤을 사용한 로그인을 보여 주는 SAM 타이밍 다이어그램](../../../docs/framework/security/media/signinusingconrols-sam.gif "SignInUsingConrols_SAM")</span><span class="sxs-lookup"><span data-stu-id="7ff20-147">![SAM timing diagram showing sign&#45;in using controls](../../../docs/framework/security/media/signinusingconrols-sam.gif "SignInUsingConrols_SAM")</span></span>  
  
### <a name="events"></a><span data-ttu-id="7ff20-148">이벤트</span><span class="sxs-lookup"><span data-stu-id="7ff20-148">Events</span></span>  
 <span data-ttu-id="7ff20-149"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule><xref:System.IdentityModel.Services.SessionAuthenticationModule> 및 해당 부모 클래스인 <xref:System.IdentityModel.Services.HttpModuleBase>는 HTTP 요청의 여러 처리 단계에서 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-149"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule>, <xref:System.IdentityModel.Services.SessionAuthenticationModule>, and their parent class, <xref:System.IdentityModel.Services.HttpModuleBase>, raise events at various stages of processing of an HTTP request.</span></span> <span data-ttu-id="7ff20-150">[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] 응용 프로그램의 `global.asax` 파일에서 이러한 이벤트를 처리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-150">You can handle these events in the `global.asax` file of your [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] application.</span></span>  
  
- <span data-ttu-id="7ff20-151">ASP.NET 인프라는 모듈의 <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> 메서드를 호출하여 모듈을 초기화합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-151">The ASP.NET infrastructure invokes the module’s <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> method to initialize the module.</span></span>  
  
- <span data-ttu-id="7ff20-152">ASP.NET 인프라가 <xref:System.IdentityModel.Services.HttpModuleBase>에서 파생되는 애플리케이션의 모듈 중 하나에서 <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> 메서드를 처음 호출할 때 <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfigurationCreated?displayProperty=nameWithType> 이벤트가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-152">The <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfigurationCreated?displayProperty=nameWithType> event is raised when the ASP.NET infrastructure invokes the <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> method for the first time on one of the application’s modules that derive from <xref:System.IdentityModel.Services.HttpModuleBase>.</span></span> <span data-ttu-id="7ff20-153">이 메서드는 정적 <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfiguration%2A?displayProperty=nameWithType> 속성에 액세스하여 Web.config 파일에서 구성이 로드되도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-153">This method accesses the static <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfiguration%2A?displayProperty=nameWithType> property, which causes configuration to be loaded from the Web.config file.</span></span> <span data-ttu-id="7ff20-154">이 이벤트는 이 속성에 처음 액세스할 때만 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-154">This event is only raised the first time this property is accessed.</span></span> <span data-ttu-id="7ff20-155">구성에서 초기화된 <xref:System.IdentityModel.Services.Configuration.FederationConfiguration> 개체는 이벤트 처리기의 <xref:System.IdentityModel.Services.Configuration.FederationConfigurationCreatedEventArgs.FederationConfiguration%2A?displayProperty=nameWithType> 속성을 통해 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-155">The <xref:System.IdentityModel.Services.Configuration.FederationConfiguration> object that is initialized from configuration can be accessed through the <xref:System.IdentityModel.Services.Configuration.FederationConfigurationCreatedEventArgs.FederationConfiguration%2A?displayProperty=nameWithType> property in an event handler.</span></span> <span data-ttu-id="7ff20-156">이 이벤트를 사용하여 모듈에 적용되기 전에 구성을 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-156">You can use this event to modify the configuration before it is applied to any modules.</span></span> <span data-ttu-id="7ff20-157">Application_Start 메서드에 이 이벤트에 대한 처리기를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-157">You can add a handler for this event in the Application_Start method:</span></span>  
  
    ```  
    void Application_Start(object sender, EventArgs e)  
    {  
        FederatedAuthentication.FederationConfigurationCreated += new EventHandler<FederationConfigurationCreatedEventArgs>(FederatedAuthentication_FederationConfigurationCreated);  
    }  
    ```  
  
     <span data-ttu-id="7ff20-158">각 모듈은 <xref:System.IdentityModel.Services.HttpModuleBase.InitializeModule%2A?displayProperty=nameWithType> 및 <xref:System.IdentityModel.Services.HttpModuleBase.InitializePropertiesFromConfiguration%2A?displayProperty=nameWithType> 추상 메서드를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-158">Each module overrides the <xref:System.IdentityModel.Services.HttpModuleBase.InitializeModule%2A?displayProperty=nameWithType> and <xref:System.IdentityModel.Services.HttpModuleBase.InitializePropertiesFromConfiguration%2A?displayProperty=nameWithType> abstract methods.</span></span> <span data-ttu-id="7ff20-159">첫 번째 메서드는 모듈에 관련된 ASP.NET 파이프라인 이벤트에 대한 처리기를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-159">The first of these methods adds handlers for ASP.NET pipeline events that are of interest to the module.</span></span> <span data-ttu-id="7ff20-160">대부분의 경우 모듈의 기본 구현만으로 충분합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-160">In most cases the module’s default implementation will suffice.</span></span> <span data-ttu-id="7ff20-161">두 번째 메서드는 해당 <xref:System.IdentityModel.Services.HttpModuleBase.FederationConfiguration%2A?displayProperty=nameWithType> 속성에서 모듈의 속성을 초기화합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-161">The second of these methods initializes the module’s properties from its <xref:System.IdentityModel.Services.HttpModuleBase.FederationConfiguration%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="7ff20-162">이전에 로드된 구성의 복사본입니다. <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> 또는 <xref:System.IdentityModel.Services.SessionAuthenticationModule>에서 파생하는 클래스의 구성에서 새 속성의 초기화를 지원하려는 경우 이 두 번째 메서드를 재정의해야 할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-162">(This is a copy of the configuration that was loaded previously.) You may need to override this second method if you want to support the initialization of new properties from configuration in classes that you derive from <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> or <xref:System.IdentityModel.Services.SessionAuthenticationModule>.</span></span> <span data-ttu-id="7ff20-163">이러한 경우 <xref:System.IdentityModel.Configuration.IdentityConfiguration>, <xref:System.IdentityModel.Services.Configuration.WsFederationConfiguration> 또는 <xref:System.IdentityModel.Services.Configuration.FederationConfiguration> 등에서 추가된 구성 속성을 지원하기 위해 적절한 구성 개체에서 파생해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-163">In such cases you would also need to derive from the appropriate configuration objects to support the added configuration properties; for example, from <xref:System.IdentityModel.Configuration.IdentityConfiguration>, <xref:System.IdentityModel.Services.Configuration.WsFederationConfiguration>, or <xref:System.IdentityModel.Services.Configuration.FederationConfiguration>.</span></span>  
  
- <span data-ttu-id="7ff20-164">WS-FAM은 STS에서 발급된 보안 토큰을 가로챌 때 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenReceived> 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-164">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenReceived> event when it intercepts a security token that has been issued by the STS.</span></span>  
  
- <span data-ttu-id="7ff20-165">WS-FAM은 토큰의 유효성을 검사한 후 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenValidated> 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-165">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenValidated> event after it has validated the token.</span></span>  
  
- <span data-ttu-id="7ff20-166"><xref:System.IdentityModel.Services.SessionAuthenticationModule> 모듈은 사용자에 대한 세션 보안 토큰을 만들 때 <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenCreated> 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-166">The <xref:System.IdentityModel.Services.SessionAuthenticationModule> raises the <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenCreated> event when it creates a session security token for the user.</span></span>  
  
- <span data-ttu-id="7ff20-167"><xref:System.IdentityModel.Services.SessionAuthenticationModule>은 세션 보안 토큰을 포함하는 쿠키를 사용하여 후속 요청을 가로챌 때 <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenReceived> 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-167">The <xref:System.IdentityModel.Services.SessionAuthenticationModule> raises the <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenReceived> event when it intercepts subsequent requests with the cookie that contains the session security token.</span></span>  
  
- <span data-ttu-id="7ff20-168">WS-FAM은 사용자를 발급자로 리디렉션하기 전에 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider> 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-168">Before the WS-FAM redirects the user to the issuer, it raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider> event.</span></span> <span data-ttu-id="7ff20-169">WS-Federation 로그인 요청은 이벤트에 전달된 <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs>의 <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs.SignInRequestMessage%2A> 속성을 통해 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-169">The WS-Federation sign-in request is available through the <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs.SignInRequestMessage%2A> property of the <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs> passed in the event.</span></span> <span data-ttu-id="7ff20-170">이 요청을 발급자에게 보내기 전에 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-170">You may choose to modify the request before sending this out to the issuer.</span></span>  
  
- <span data-ttu-id="7ff20-171">쿠키가 성공적으로 작성되고 사용자가 로그인하면 WS-FAM이 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignedIn>을 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-171">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignedIn> event when the cookie is successfully written and the user is signed in.</span></span>  
  
- <span data-ttu-id="7ff20-172">각 사용자에 대해 세션이 닫히기 때문에 WS-FAM은 세션당 한 번 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SigningOut> 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-172">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SigningOut> event one time per session as the session is being closed down for each user.</span></span> <span data-ttu-id="7ff20-173">클라이언트 쪽에서 세션이 닫힌 경우(예: 세션 쿠키 삭제)에는 이벤트가 발생하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-173">It is not raised if the session is closed down on the client-side (for example, by deleting the session cookie).</span></span> <span data-ttu-id="7ff20-174">SSO 환경에서는 IP-STS가 각 RP에 로그아웃하도록 요청할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-174">In an SSO environment, the IP-STS can request each RP to sign out, too.</span></span> <span data-ttu-id="7ff20-175">이 경우에도 <xref:System.IdentityModel.Services.SigningOutEventArgs.IsIPInitiated%2A>가 `true`로 설정되어 이 이벤트가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-175">This will also raise this event, with <xref:System.IdentityModel.Services.SigningOutEventArgs.IsIPInitiated%2A> set to `true`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7ff20-176"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule> 또는 <xref:System.IdentityModel.Services.SessionAuthenticationModule>에서 발생하는 이벤트 중에는 <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> 속성을 사용하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-176">You should not use the <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> property during any event raised by <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> or <xref:System.IdentityModel.Services.SessionAuthenticationModule>.</span></span> <span data-ttu-id="7ff20-177">이는 인증 프로세스 중 이벤트가 발생하는 반면 <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType>은 인증 프로세스 후에 설정되기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-177">This is because <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> is set after the authentication process, while events are raised during the authentication process.</span></span>  
  
### <a name="configuration-of-federated-authentication"></a><span data-ttu-id="7ff20-178">페더레이션된 인증 구성</span><span class="sxs-lookup"><span data-stu-id="7ff20-178">Configuration of Federated Authentication</span></span>  
 <span data-ttu-id="7ff20-179">WS-FAM 및 SAM은 [\<federationConfiguration>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/federationconfiguration.md) 요소를 통해 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-179">The WS-FAM and SAM are configured through the [\<federationConfiguration>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/federationconfiguration.md) element.</span></span> <span data-ttu-id="7ff20-180">[\<wsFederation>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/wsfederation.md) 자식 요소는 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Issuer%2A> 속성 및 <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Realm%2A> 속성 같은 WS-FAM 속성의 기본값을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-180">The [\<wsFederation>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/wsfederation.md) child element configures default values for the WS-FAM properties; such as the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Issuer%2A> property and the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Realm%2A> property.</span></span> <span data-ttu-id="7ff20-181">일부 WS-FAM 이벤트(예: <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider>)에 대한 처리기를 제공하여 요청별로 이러한 값을 변경할 수 있습니다. SAM에서 사용되는 쿠키 처리기는 [\<cookieHandler>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/cookiehandler.md) 자식 요소를 통해 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-181">(These values can be changed on a per request basis by providing handlers for some of the WS-FAM events; for example, <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider>.) The cookie handler that is used by the SAM is configured through the [\<cookieHandler>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/cookiehandler.md) child element.</span></span> <span data-ttu-id="7ff20-182">WIF는 <xref:System.IdentityModel.Services.ChunkedCookieHandler> 클래스에 구현된 기본 쿠키 처리기를 제공하며, [\<chunkedCookieHandler>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/chunkedcookiehandler.md) 요소를 통해 해당 청크 크기를 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-182">WIF provides a default cookie handler implemented in the <xref:System.IdentityModel.Services.ChunkedCookieHandler> class that can have its chunk size set through the [\<chunkedCookieHandler>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/chunkedcookiehandler.md) element.</span></span> <span data-ttu-id="7ff20-183">`<federationConfiguration>` 요소는 <xref:System.Security.Claims.ClaimsAuthenticationManager>, <xref:System.Security.Claims.ClaimsAuthorizationManager> 등 응용 프로그램에서 사용되는 다른 WIF 구성 요소에 대한 구성을 제공하는 <xref:System.IdentityModel.Configuration.IdentityConfiguration>을 참조합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-183">The `<federationConfiguration>` element references an <xref:System.IdentityModel.Configuration.IdentityConfiguration>, which provides configuration for other WIF components used in the application, such as the <xref:System.Security.Claims.ClaimsAuthenticationManager> and the <xref:System.Security.Claims.ClaimsAuthorizationManager>.</span></span> <span data-ttu-id="7ff20-184">`<federationConfiguration>` 요소의 `identityConfigurationName` 특성에 명명된 [\<identityConfiguration>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) 요소를 지정하여 ID 구성을 명시적으로 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-184">The identity configuration may be referenced explicitly by specifying a named [\<identityConfiguration>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) element in the `identityConfigurationName` attribute of the `<federationConfiguration>` element.</span></span> <span data-ttu-id="7ff20-185">ID 구성이 명시적으로 참조되지 않은 경우 기본 ID 구성이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-185">If the identity configuration is not referenced explicitly, the default identity configuration will be used.</span></span>  
  
 <span data-ttu-id="7ff20-186">다음 XML에서는 ASP.NET RP(신뢰 당사자) 애플리케이션의 구성을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-186">The following XML shows a configuration of an ASP.NET relying party (RP) application.</span></span> <span data-ttu-id="7ff20-187"><xref:System.IdentityModel.Configuration.SystemIdentityModelSection> 및 <xref:System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection> 구성 섹션은 `<configSections>` 요소 아래에 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-187">The <xref:System.IdentityModel.Configuration.SystemIdentityModelSection> and <xref:System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection> configuration sections are added under the `<configSections>` element.</span></span> <span data-ttu-id="7ff20-188">SAM 및 WS-FAM은 HTTP 모듈의 `<system.webServer>`/`<modules>` 요소 아래에 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-188">The SAM and WS-FAM are added to the HTTP Modules under the `<system.webServer>`/`<modules>` element.</span></span> <span data-ttu-id="7ff20-189">최종적으로, WIF 구성 요소는 `<system.identityModel>`/`<identityConfiguration>` 및 `<system.identityModel.services>`/`<federationConfiguration>` 요소 아래에 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-189">Finally the WIF components are configured under the `<system.identityModel>`/`<identityConfiguration>` and `<system.identityModel.services>`/`<federationConfiguration>` elements.</span></span> <span data-ttu-id="7ff20-190">이 구성은 기본 쿠키 처리기이고 `<cookieHandler>` 요소에 지정된 쿠키 처리기 유형이 없기 때문에 청크 분할된 쿠키 처리기를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-190">This configuration specifies the chunked cookie handler as it is the default cookie handler and there is not a cookie handler type specified in the `<cookieHandler>` element.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="7ff20-191">다음 예제에서 `<wsFederation>` 요소의 `requireHttps` 특성과 `<cookieHandler>` 요소의 `requireSsl` 특성은 둘 다 `false`입니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-191">In the following example, both the `requireHttps` attribute of the `<wsFederation>` element and the `requireSsl` attribute of the `<cookieHandler>` element are `false`.</span></span> <span data-ttu-id="7ff20-192">이 경우 보안 위협이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-192">This presents a potential security threat.</span></span> <span data-ttu-id="7ff20-193">프로덕션에서는 이러한 두 값을 모두 `true`로 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7ff20-193">In production, both these values should be set `true`.</span></span>  
  
```xml  
<configuration>  
  <configSections>  
    <section name="system.identityModel" type="System.IdentityModel.Configuration.SystemIdentityModelSection, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />  
    <section name="system.identityModel.services" type="System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />  
  </configSections>  
  
  ...  
  
  <system.webServer>  
    <modules>  
      <add name="WSFederationAuthenticationModule" type="System.IdentityModel.Services.WSFederationAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" preCondition="managedHandler" />  
      <add name="SessionAuthenticationModule" type="System.IdentityModel.Services.SessionAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" preCondition="managedHandler" />  
    </modules>  
  </system.webServer>  
  
  <system.identityModel>  
    <identityConfiguration>  
      <audienceUris>  
        <add value="http://localhost:50969/" />  
      </audienceUris>  
      <certificateValidation certificateValidationMode="None" />  
      <issuerNameRegistry type="System.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">  
        <trustedIssuers>  
          <add thumbprint="9B74CB2F320F7AAFC156E1252270B1DC01EF40D0" name="LocalSTS" />  
        </trustedIssuers>  
      </issuerNameRegistry>  
    </identityConfiguration>  
  </system.identityModel>  
  <system.identityModel.services>  
    <federationConfiguration>  
      <wsFederation passiveRedirectEnabled="true" issuer="http://localhost:15839/wsFederationSTS/Issue" realm="http://localhost:50969/" reply="http://localhost:50969/" requireHttps="false" />  
      <cookieHandler requireSsl="false" />  
    </federationConfiguration>  
  </system.identityModel.services>  
</configuration>  
```  
  
## <a name="see-also"></a><span data-ttu-id="7ff20-194">참고자료</span><span class="sxs-lookup"><span data-stu-id="7ff20-194">See also</span></span>

- <xref:System.IdentityModel.Services.SessionAuthenticationModule>
- <xref:System.IdentityModel.Services.WSFederationAuthenticationModule>
- [<span data-ttu-id="7ff20-195">\<federationConfiguration></span><span class="sxs-lookup"><span data-stu-id="7ff20-195">\<federationConfiguration></span></span>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/federationconfiguration.md)
