---
title: 워크플로 서비스 호스트 내부 기능
ms.date: 03/30/2017
ms.assetid: af44596f-bf6a-4149-9f04-08d8e8f45250
ms.openlocfilehash: c3293fe7f835ed0d5b3b62404a1f3f2e20b73fd6
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54708495"
---
# <a name="workflow-service-host-internals"></a><span data-ttu-id="f02b5-102">워크플로 서비스 호스트 내부 기능</span><span class="sxs-lookup"><span data-stu-id="f02b5-102">Workflow Service Host Internals</span></span>
<span data-ttu-id="f02b5-103"><xref:System.ServiceModel.WorkflowServiceHost>에서는 워크플로 서비스에 대한 호스트를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-103"><xref:System.ServiceModel.WorkflowServiceHost> provides a host for workflow services.</span></span> <span data-ttu-id="f02b5-104">들어오는 메시지를 수신 대기하여 적절한 워크플로 서비스 인스턴스로 라우팅하고 유휴 워크플로의 언로드 및 유지를 제어하는 등의 작업을 담당합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-104">It is responsible for listening for incoming messages and routing them to the appropriate workflow service instance, it controls unloading and persisting of idle workflows, and more.</span></span> <span data-ttu-id="f02b5-105">이 항목에서는 WorkflowServiceHost가 들어오는 메시지를 처리하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-105">This topic describes how WorkflowServiceHost processes incoming messages.</span></span>  
  
## <a name="workflowservicehost-overview"></a><span data-ttu-id="f02b5-106">WorkflowServiceHost 개요</span><span class="sxs-lookup"><span data-stu-id="f02b5-106">WorkflowServiceHost Overview</span></span>  
 <span data-ttu-id="f02b5-107"><xref:System.ServiceModel.WorkflowServiceHost> 클래스는 워크플로 서비스를 호스트하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-107">The <xref:System.ServiceModel.WorkflowServiceHost> class is used to host workflow services.</span></span> <span data-ttu-id="f02b5-108">들어오는 메시지를 수신 대기하여 적절한 서비스 인스턴스로 라우팅하고 필요에 따라 새 인스턴스를 만들거나 영구 저장소에서 기존 인스턴스를 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-108">It listens for incoming messages and routes them to the appropriate service instance, creating new instances or loading existing instances from durable storage as needed.</span></span>  <span data-ttu-id="f02b5-109">다음 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>의 작동 방식을 간략하게 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-109">The following diagram illustrates on a high level how <xref:System.ServiceModel.WorkflowServiceHost> works.</span></span>  
  
 <span data-ttu-id="f02b5-110">![WorkflowServiceHost 개요](../../../../docs/framework/wcf/feature-details/media/wfshhighlevel.gif "WFSHHighLevel")</span><span class="sxs-lookup"><span data-stu-id="f02b5-110">![WorkflowServiceHost Overview](../../../../docs/framework/wcf/feature-details/media/wfshhighlevel.gif "WFSHHighLevel")</span></span>  
  
 <span data-ttu-id="f02b5-111">이 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>가 .xamlx 파일에서 워크플로 서비스 정의를 로드하고 구성 파일에서 구성 정보를 로드하는 것을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-111">This diagram shows that <xref:System.ServiceModel.WorkflowServiceHost> loads workflow service definitions from .xamlx files and loads configuration information from a configuration file.</span></span> <span data-ttu-id="f02b5-112">또한 추적 프로필에서 추적 구성을 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-112">It also loads tracking configuration from the tracking profile.</span></span> <span data-ttu-id="f02b5-113"><xref:System.ServiceModel.WorkflowServiceHost>는 제어 작업을 워크플로 인스턴스로 보내는 데 사용할 수 있는 워크플로 제어 엔드포인트를 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-113"><xref:System.ServiceModel.WorkflowServiceHost> exposes a workflow control endpoint which allows you to send control operations to workflow instances.</span></span>  <span data-ttu-id="f02b5-114">자세한 내용은 참조 [워크플로 제어 끝점 샘플](../../../../docs/framework/wcf/feature-details/workflow-control-endpoint.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-114">For more information see [Workflow Control Endpoint sample](../../../../docs/framework/wcf/feature-details/workflow-control-endpoint.md).</span></span>  
  
 <span data-ttu-id="f02b5-115"><xref:System.ServiceModel.WorkflowServiceHost>는 들어오는 응용 프로그램 메시지를 수신 대기하는 응용 프로그램 끝점도 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-115"><xref:System.ServiceModel.WorkflowServiceHost> also exposes application endpoints that listen for incoming application messages.</span></span> <span data-ttu-id="f02b5-116">들어오는 메시지가 도착하면 적절한 워크플로 서비스 인스턴스로 전송됩니다(현재 로드되어 있는 경우).</span><span class="sxs-lookup"><span data-stu-id="f02b5-116">When an incoming message arrives it is sent to the appropriate workflow service instance (if it is currently loaded).</span></span> <span data-ttu-id="f02b5-117">필요한 경우 새 워크플로 인스턴스가 만들어지고,</span><span class="sxs-lookup"><span data-stu-id="f02b5-117">If needed a new workflow instance is created.</span></span> <span data-ttu-id="f02b5-118">기존 인스턴스가 유지된 경우에는 지속성 저장소에서 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-118">Or if an existing instance has been persisted it is loaded from the persistence store.</span></span>  
  
## <a name="workflowservicehost-details"></a><span data-ttu-id="f02b5-119">WorkflowServiceHost 세부 정보</span><span class="sxs-lookup"><span data-stu-id="f02b5-119">WorkflowServiceHost Details</span></span>  
 <span data-ttu-id="f02b5-120">다음 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 메시지를 처리하는 방법을 자세히 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-120">The following diagram shows how <xref:System.ServiceModel.WorkflowServiceHost> handles messages in a bit more detail.</span></span>  
  
 <span data-ttu-id="f02b5-121">![워크플로 서비스 호스트 메시지 흐름](../../../../docs/framework/wcf/feature-details/media/wfshmessageflow.gif "WFSHMessageFlow")</span><span class="sxs-lookup"><span data-stu-id="f02b5-121">![Workflow Service Host Message Flow](../../../../docs/framework/wcf/feature-details/media/wfshmessageflow.gif "WFSHMessageFlow")</span></span>  
  
 <span data-ttu-id="f02b5-122">이 다이어그램에서는 세 가지 엔드포인트인 응용 프로그램 엔드포인트, 워크플로 제어 엔드포인트 및 워크플로 호스팅 엔드포인트를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-122">This diagram shows three different endpoints, an application endpoint, a workflow control endpoint, and a workflow hosting endpoint.</span></span> <span data-ttu-id="f02b5-123">응용 프로그램 엔드포인트는 특정 워크플로 인스턴스에 바인딩된 메시지를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-123">The application endpoint receives messages that are bound for a specific workflow instance.</span></span> <span data-ttu-id="f02b5-124">워크플로 제어 엔드포인트는 제어 작업을 수신 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-124">The workflow control endpoint listens for control operations.</span></span> <span data-ttu-id="f02b5-125">워크플로 호스팅 엔드포인트는 <xref:System.ServiceModel.WorkflowServiceHost>가 서비스가 아닌 워크플로를 로드하고 실행하도록 하는 메시지를 수신 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-125">The workflow hosting endpoint listens for messages that cause <xref:System.ServiceModel.WorkflowServiceHost> to load and execute non-service workflows.</span></span> <span data-ttu-id="f02b5-126">다이어그램에 나와 있듯이 모든 메시지는 WCF 런타임을 통해 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-126">As shown in the diagram all messages are processed through the WCF runtime.</span></span>  <span data-ttu-id="f02b5-127">워크플로 서비스 인스턴스 제한은 <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentInstances%2A> 속성을 사용하여 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-127">Workflow service instance throttling is achieved by using the <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentInstances%2A> property.</span></span> <span data-ttu-id="f02b5-128">이 속성은 동시 워크플로 서비스 인스턴스 수를 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-128">This property will limit the number of concurrent workflow service instances.</span></span> <span data-ttu-id="f02b5-129">이 제한을 초과하면 새 워크플로 서비스 인스턴스에 대한 추가 요청이나 지속형 워크플로 인스턴스 활성화 요청이 큐에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-129">When this throttle is exceeded any additional requests for new workflow service instances or requests to activate persisted workflow instances will be queued.</span></span> <span data-ttu-id="f02b5-130">큐에 대기 중인 요청은 새 인스턴스에 대한 요청인지, 실행 중인 지속형 인스턴스에 대한 요청인지에 관계없이 FIFO 순서대로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-130">The queued requests are processed in FIFO order regardless of whether they are requests for a new instance or a running, persisted instance.</span></span> <span data-ttu-id="f02b5-131">처리되지 않은 예외가 처리되는 방법과 유휴 워크플로 서비스가 언로드되고 지속되는 방법을 결정하는 호스트 정책 정보가 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-131">Host policy information is loaded that determines how unhandled exceptions are dealt with, and how idle workflow services are unloaded and persisted.</span></span> <span data-ttu-id="f02b5-132">이러한 항목에 대 한 자세한 내용은 참조 하세요. [방법: 워크플로 구성 합니다. 처리 되지 않은 예외 동작 WorkflowServiceHost 사용 하 여](../../../../docs/framework/wcf/feature-details/config-workflow-unhandled-exception-workflowservicehost.md) 고 [방법: WorkflowServiceHost를 사용 하 여 유휴 동작 구성](../../../../docs/framework/wcf/feature-details/how-to-configure-idle-behavior-with-workflowservicehost.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-132">For more information about these topics see [How to: Configure Workflow Unhandled Exception Behavior with WorkflowServiceHost](../../../../docs/framework/wcf/feature-details/config-workflow-unhandled-exception-workflowservicehost.md) and [How to: Configure Idle Behavior with WorkflowServiceHost](../../../../docs/framework/wcf/feature-details/how-to-configure-idle-behavior-with-workflowservicehost.md).</span></span> <span data-ttu-id="f02b5-133">워크플로 인스턴스는 호스트 정책에 따라 유지되고 필요한 경우 다시 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-133">Workflow instances are persisted according to host policies and are reloaded when needed.</span></span> <span data-ttu-id="f02b5-134">워크플로 지 속성 참조에 대 한 자세한 내용은: [방법: WorkflowServiceHost를 사용 하 여 지 속성을 구성](../../../../docs/framework/wcf/feature-details/how-to-configure-persistence-with-workflowservicehost.md), [장기 실행 워크플로 서비스를 만드는](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md), 및 [워크플로 지 속성](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-134">For more information about workflow persistence see: [How to: Configure Persistence with WorkflowServiceHost](../../../../docs/framework/wcf/feature-details/how-to-configure-persistence-with-workflowservicehost.md), [Creating a Long-running Workflow Service](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md), and [Workflow Persistence](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md).</span></span>  
  
 <span data-ttu-id="f02b5-135">다음 그림에서는 WorkflowServiceHost.Open이 호출될 때 일어나는 상황을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-135">The following illustration shows what the WorkflowServiceHost.Open is called.</span></span>  
  
 <span data-ttu-id="f02b5-136">![WorkflowServiceHost.Open이 호출 하는 경우](../../../../docs/framework/wcf/feature-details/media/wfhostopen.gif "WFHostOpen")</span><span class="sxs-lookup"><span data-stu-id="f02b5-136">![When WorkflowServiceHost.Open is called](../../../../docs/framework/wcf/feature-details/media/wfhostopen.gif "WFHostOpen")</span></span>  
  
 <span data-ttu-id="f02b5-137">워크플로가 XAML에서 로드되고 작업 트리가 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-137">The workflow is loaded from XAML and the activity tree is created.</span></span> <span data-ttu-id="f02b5-138"><xref:System.ServiceModel.WorkflowServiceHost>가 작업 트리를 단계별로 진행하면서 서비스 설명을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-138"><xref:System.ServiceModel.WorkflowServiceHost> walks the activity tree and creates the service description.</span></span> <span data-ttu-id="f02b5-139">구성이 호스트에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-139">Configuration is applied to the host.</span></span> <span data-ttu-id="f02b5-140">마지막으로 호스트가 들어오는 메시지를 수신 대기하기 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-140">Finally the host begins to listen for incoming messages.</span></span>  
  
 <span data-ttu-id="f02b5-141">다음 그림에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 CanCreateInstance가 `true`로 설정된 Receive 작업에 바인딩된 메시지를 받을 때 수행하는 작업을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-141">The following illustration shows what the <xref:System.ServiceModel.WorkflowServiceHost> does when it receives a message bound for a Receive activity that has CanCreateInstance set to `true`.</span></span>  
  
 <span data-ttu-id="f02b5-142">![워크플로 서비스 호스트는 메시지를 받으면](../../../../docs/framework/wcf/feature-details/media/wfhreceivemessagecci.gif "WFHReceiveMessageCCI")</span><span class="sxs-lookup"><span data-stu-id="f02b5-142">![Workflow Service Host Receives a message](../../../../docs/framework/wcf/feature-details/media/wfhreceivemessagecci.gif "WFHReceiveMessageCCI")</span></span>  
  
 <span data-ttu-id="f02b5-143">메시지가 도착하고 WCF 채널 스택에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-143">The message arrives and is processed by the WCF channel stack.</span></span> <span data-ttu-id="f02b5-144">스로틀이 확인되고 상관 관계 쿼리가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-144">Throttles are checked and correlation queries are executed.</span></span> <span data-ttu-id="f02b5-145">메시지가 기존 인스턴스에 바인딩된 경우 메시지가 배달됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-145">If the message is bound for an existing instance the message is delivered.</span></span> <span data-ttu-id="f02b5-146">새 인스턴스를 만들어야 하는 경우에는 Receive 활동의 CanCreateInstance 속성이 확인됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-146">If a new instance needs to be created, the Receive activity’s CanCreateInstance property is checked.</span></span> <span data-ttu-id="f02b5-147">이 속성이 true로 설정되었으면 새 인스턴스가 만들어지고 메시지가 배달됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-147">If it is set to true, a new instance is created and the message is delivered.</span></span>  
  
 <span data-ttu-id="f02b5-148">다음 그림에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 CanCreateInstance가 false로 설정된 Receive 작업에 바인딩된 메시지를 받을 때 수행하는 작업을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-148">The following illustration shows what the <xref:System.ServiceModel.WorkflowServiceHost> does when it receives a message bound for a Receive activity that has CanCreateInstance set to false.</span></span>  
  
 <span data-ttu-id="f02b5-149">![WorkflowServiceHost에 메시지 수신](../../../../docs/framework/wcf/feature-details/media/wfshreceivemessage.gif "WFSHReceiveMessage")</span><span class="sxs-lookup"><span data-stu-id="f02b5-149">![WorkflowServiceHost receives a message](../../../../docs/framework/wcf/feature-details/media/wfshreceivemessage.gif "WFSHReceiveMessage")</span></span>  
  
 <span data-ttu-id="f02b5-150">메시지가 도착하고 WCF 채널 스택에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-150">The message arrives and is processed by the WCF channel stack.</span></span> <span data-ttu-id="f02b5-151">스로틀이 확인되고 상관 관계 쿼리가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-151">Throttles are checked and correlation queries are executed.</span></span> <span data-ttu-id="f02b5-152">메시지가 기존 인스턴스에 바인딩되어 있으므로(CanCreateInstance가 false이기 때문) 인스턴스가 지속성 저장소에서 로드되고 책갈피가 다시 시작되며 워크플로가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-152">The message is bound for an existing instance (because CanCreateInstance is false) so the instance is loaded from persistence store, the bookmark is resumed and the workflow executes.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="f02b5-153">SQL Server가 NamedPipe 프로토콜에서만 수신하도록 구성되어 있으면 워크플로 서비스 호스트가 열리지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f02b5-153">Workflow Service Host will fail to open if SQL Server is configured to listen on NamedPipe protocol only.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f02b5-154">참고자료</span><span class="sxs-lookup"><span data-stu-id="f02b5-154">See also</span></span>

- [<span data-ttu-id="f02b5-155">워크플로 서비스</span><span class="sxs-lookup"><span data-stu-id="f02b5-155">Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/workflow-services.md)
- [<span data-ttu-id="f02b5-156">워크플로 서비스 호스팅</span><span class="sxs-lookup"><span data-stu-id="f02b5-156">Hosting Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/hosting-workflow-services.md)
- [<span data-ttu-id="f02b5-157">워크플로 제어 엔드포인트</span><span class="sxs-lookup"><span data-stu-id="f02b5-157">Workflow Control Endpoint</span></span>](../../../../docs/framework/wcf/feature-details/workflow-control-endpoint.md)
- [<span data-ttu-id="f02b5-158">방법: 워크플로 구성 합니다. 처리 되지 않은 예외 동작 WorkflowServiceHost 사용 하 여</span><span class="sxs-lookup"><span data-stu-id="f02b5-158">How to: Configure Workflow Unhandled Exception Behavior with WorkflowServiceHost</span></span>](../../../../docs/framework/wcf/feature-details/config-workflow-unhandled-exception-workflowservicehost.md)
- [<span data-ttu-id="f02b5-159">장기 실행 워크플로 서비스 만들기</span><span class="sxs-lookup"><span data-stu-id="f02b5-159">Creating a Long-running Workflow Service</span></span>](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md)
- [<span data-ttu-id="f02b5-160">워크플로 유지</span><span class="sxs-lookup"><span data-stu-id="f02b5-160">Workflow Persistence</span></span>](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)
