---
title: "워크플로 서비스 호스트 내부 기능"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: af44596f-bf6a-4149-9f04-08d8e8f45250
caps.latest.revision: "5"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 9d41ff3e83b6517194c34dec5f7f768299f612bd
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/21/2017
---
# <a name="workflow-service-host-internals"></a><span data-ttu-id="0ab34-102">워크플로 서비스 호스트 내부 기능</span><span class="sxs-lookup"><span data-stu-id="0ab34-102">Workflow Service Host Internals</span></span>
<span data-ttu-id="0ab34-103"><xref:System.ServiceModel.WorkflowServiceHost>에서는 워크플로 서비스에 대한 호스트를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-103"><xref:System.ServiceModel.WorkflowServiceHost> provides a host for workflow services.</span></span> <span data-ttu-id="0ab34-104">들어오는 메시지를 수신 대기하여 적절한 워크플로 서비스 인스턴스로 라우팅하고 유휴 워크플로의 언로드 및 유지를 제어하는 등의 작업을 담당합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-104">It is responsible for listening for incoming messages and routing them to the appropriate workflow service instance, it controls unloading and persisting of idle workflows, and more.</span></span> <span data-ttu-id="0ab34-105">이 항목에서는 WorkflowServiceHost가 들어오는 메시지를 처리하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-105">This topic describes how WorkflowServiceHost processes incoming messages.</span></span>  
  
## <a name="workflowservicehost-overview"></a><span data-ttu-id="0ab34-106">WorkflowServiceHost 개요</span><span class="sxs-lookup"><span data-stu-id="0ab34-106">WorkflowServiceHost Overview</span></span>  
 <span data-ttu-id="0ab34-107"><xref:System.ServiceModel.WorkflowServiceHost> 클래스는 워크플로 서비스를 호스트하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-107">The <xref:System.ServiceModel.WorkflowServiceHost> class is used to host workflow services.</span></span> <span data-ttu-id="0ab34-108">들어오는 메시지를 수신 대기하여 적절한 서비스 인스턴스로 라우팅하고 필요에 따라 새 인스턴스를 만들거나 영구 저장소에서 기존 인스턴스를 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-108">It listens for incoming messages and routes them to the appropriate service instance, creating new instances or loading existing instances from durable storage as needed.</span></span>  <span data-ttu-id="0ab34-109">다음 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>의 작동 방식을 간략하게 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-109">The following diagram illustrates on a high level how <xref:System.ServiceModel.WorkflowServiceHost> works.</span></span>  
  
 <span data-ttu-id="0ab34-110">![WorkflowServiceHost 개요](../../../../docs/framework/wcf/feature-details/media/wfshhighlevel.gif "WFSHHighLevel")</span><span class="sxs-lookup"><span data-stu-id="0ab34-110">![WorkflowServiceHost Overview](../../../../docs/framework/wcf/feature-details/media/wfshhighlevel.gif "WFSHHighLevel")</span></span>  
  
 <span data-ttu-id="0ab34-111">이 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>가 .xamlx 파일에서 워크플로 서비스 정의를 로드하고 구성 파일에서 구성 정보를 로드하는 것을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-111">This diagram shows that <xref:System.ServiceModel.WorkflowServiceHost> loads workflow service definitions from .xamlx files and loads configuration information from a configuration file.</span></span> <span data-ttu-id="0ab34-112">또한 추적 프로필에서 추적 구성을 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-112">It also loads tracking configuration from the tracking profile.</span></span> <span data-ttu-id="0ab34-113"><xref:System.ServiceModel.WorkflowServiceHost>는 제어 작업을 워크플로 인스턴스로 보내는 데 사용할 수 있는 워크플로 제어 끝점을 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-113"><xref:System.ServiceModel.WorkflowServiceHost> exposes a workflow control endpoint which allows you to send control operations to workflow instances.</span></span>  <span data-ttu-id="0ab34-114">자세한 내용은 참조 [워크플로 제어 끝점](../../../../docs/framework/wcf/feature-details/workflow-control-endpoint.md) 및 [워크플로 관리 끝점 샘플](../../../../docs/framework/windows-workflow-foundation/samples/workflow-management-endpoint-sample.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-114">For more information see [Workflow Control Endpoint](../../../../docs/framework/wcf/feature-details/workflow-control-endpoint.md) and [Workflow Management Endpoint Sample](../../../../docs/framework/windows-workflow-foundation/samples/workflow-management-endpoint-sample.md).</span></span>  
  
 <span data-ttu-id="0ab34-115"><xref:System.ServiceModel.WorkflowServiceHost>는 들어오는 응용 프로그램 메시지를 수신 대기하는 응용 프로그램 끝점도 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-115"><xref:System.ServiceModel.WorkflowServiceHost> also exposes application endpoints that listen for incoming application messages.</span></span> <span data-ttu-id="0ab34-116">들어오는 메시지가 도착하면 적절한 워크플로 서비스 인스턴스로 전송됩니다(현재 로드되어 있는 경우).</span><span class="sxs-lookup"><span data-stu-id="0ab34-116">When an incoming message arrives it is sent to the appropriate workflow service instance (if it is currently loaded).</span></span> <span data-ttu-id="0ab34-117">필요한 경우 새 워크플로 인스턴스가 만들어지고,</span><span class="sxs-lookup"><span data-stu-id="0ab34-117">If needed a new workflow instance is created.</span></span> <span data-ttu-id="0ab34-118">기존 인스턴스가 유지된 경우에는 지속성 저장소에서 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-118">Or if an existing instance has been persisted it is loaded from the persistence store.</span></span>  
  
## <a name="workflowservicehost-details"></a><span data-ttu-id="0ab34-119">WorkflowServiceHost 세부 정보</span><span class="sxs-lookup"><span data-stu-id="0ab34-119">WorkflowServiceHost Details</span></span>  
 <span data-ttu-id="0ab34-120">다음 다이어그램에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 메시지를 처리하는 방법을 자세히 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-120">The following diagram shows how <xref:System.ServiceModel.WorkflowServiceHost> handles messages in a bit more detail.</span></span>  
  
 <span data-ttu-id="0ab34-121">![워크플로 서비스 호스트 메시지 흐름](../../../../docs/framework/wcf/feature-details/media/wfshmessageflow.gif "WFSHMessageFlow")</span><span class="sxs-lookup"><span data-stu-id="0ab34-121">![Workflow Service Host Message Flow](../../../../docs/framework/wcf/feature-details/media/wfshmessageflow.gif "WFSHMessageFlow")</span></span>  
  
 <span data-ttu-id="0ab34-122">이 다이어그램에서는 세 가지 끝점인 응용 프로그램 끝점, 워크플로 제어 끝점 및 워크플로 호스팅 끝점을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-122">This diagram shows three different endpoints, an application endpoint, a workflow control endpoint, and a workflow hosting endpoint.</span></span> <span data-ttu-id="0ab34-123">응용 프로그램 끝점은 특정 워크플로 인스턴스에 바인딩된 메시지를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-123">The application endpoint receives messages that are bound for a specific workflow instance.</span></span> <span data-ttu-id="0ab34-124">워크플로 제어 끝점은 제어 작업을 수신 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-124">The workflow control endpoint listens for control operations.</span></span> <span data-ttu-id="0ab34-125">워크플로 호스팅 끝점은 <xref:System.ServiceModel.WorkflowServiceHost>가 서비스가 아닌 워크플로를 로드하고 실행하도록 하는 메시지를 수신 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-125">The workflow hosting endpoint listens for messages that cause <xref:System.ServiceModel.WorkflowServiceHost> to load and execute non-service workflows.</span></span> <span data-ttu-id="0ab34-126">다이어그램에 나와 있듯이 모든 메시지는 WCF 런타임을 통해 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-126">As shown in the diagram all messages are processed through the WCF runtime.</span></span>  <span data-ttu-id="0ab34-127">워크플로 서비스 인스턴스 제한은 <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentInstances%2A> 속성을 사용하여 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-127">Workflow service instance throttling is achieved by using the <xref:System.ServiceModel.Description.ServiceThrottlingBehavior.MaxConcurrentInstances%2A> property.</span></span> <span data-ttu-id="0ab34-128">이 속성은 동시 워크플로 서비스 인스턴스 수를 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-128">This property will limit the number of concurrent workflow service instances.</span></span> <span data-ttu-id="0ab34-129">이 제한을 초과하면 새 워크플로 서비스 인스턴스에 대한 추가 요청이나 지속형 워크플로 인스턴스 활성화 요청이 큐에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-129">When this throttle is exceeded any additional requests for new workflow service instances or requests to activate persisted workflow instances will be queued.</span></span> <span data-ttu-id="0ab34-130">큐에 대기 중인 요청은 새 인스턴스에 대한 요청인지, 실행 중인 지속형 인스턴스에 대한 요청인지에 관계없이 FIFO 순서대로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-130">The queued requests are processed in FIFO order regardless of whether they are requests for a new instance or a running, persisted instance.</span></span> <span data-ttu-id="0ab34-131">처리되지 않은 예외가 처리되는 방법과 유휴 워크플로 서비스가 언로드되고 지속되는 방법을 결정하는 호스트 정책 정보가 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-131">Host policy information is loaded that determines how unhandled exceptions are dealt with, and how idle workflow services are unloaded and persisted.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="0ab34-132">이러한 항목을 참조 [하는 방법: 워크플로 처리 되지 않은 예외 동작 구성 WorkflowServiceHost로](../../../../docs/framework/wcf/feature-details/config-workflow-unhandled-exception-workflowservicehost.md) 및 [하는 방법: WorkflowServiceHost로 유휴 동작 구성](../../../../docs/framework/wcf/feature-details/how-to-configure-idle-behavior-with-workflowservicehost.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-132"> these topics see [How to: Configure Workflow Unhandled Exception Behavior with WorkflowServiceHost](../../../../docs/framework/wcf/feature-details/config-workflow-unhandled-exception-workflowservicehost.md) and [How to: Configure Idle Behavior with WorkflowServiceHost](../../../../docs/framework/wcf/feature-details/how-to-configure-idle-behavior-with-workflowservicehost.md).</span></span> <span data-ttu-id="0ab34-133">워크플로 인스턴스는 호스트 정책에 따라 유지되고 필요한 경우 다시 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-133">Workflow instances are persisted according to host policies and are reloaded when needed.</span></span> <span data-ttu-id="0ab34-134">워크플로 지 속성에 대 한 자세한 내용은 참조: [하는 방법: WorkflowServiceHost로 지 속성 구성](../../../../docs/framework/wcf/feature-details/how-to-configure-persistence-with-workflowservicehost.md), [장기 실행 워크플로 서비스를 만드는](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md), 및 [워크플로 지 속성 ](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md).</span><span class="sxs-lookup"><span data-stu-id="0ab34-134">For more information about workflow persistence see: [How to: Configure Persistence with WorkflowServiceHost](../../../../docs/framework/wcf/feature-details/how-to-configure-persistence-with-workflowservicehost.md), [Creating a Long-running Workflow Service](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md), and [Workflow Persistence](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md).</span></span>  
  
 <span data-ttu-id="0ab34-135">다음 그림에서는 WorkflowServiceHost.Open이 호출될 때 일어나는 상황을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-135">The following illustration shows what the WorkflowServiceHost.Open is called.</span></span>  
  
 <span data-ttu-id="0ab34-136">![WorkflowServiceHost.Open이 호출](../../../../docs/framework/wcf/feature-details/media/wfhostopen.gif "WFHostOpen")</span><span class="sxs-lookup"><span data-stu-id="0ab34-136">![When WorkflowServiceHost.Open is called](../../../../docs/framework/wcf/feature-details/media/wfhostopen.gif "WFHostOpen")</span></span>  
  
 <span data-ttu-id="0ab34-137">워크플로가 XAML에서 로드되고 작업 트리가 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-137">The workflow is loaded from XAML and the activity tree is created.</span></span> <span data-ttu-id="0ab34-138"><xref:System.ServiceModel.WorkflowServiceHost>가 작업 트리를 단계별로 진행하면서 서비스 설명을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-138"><xref:System.ServiceModel.WorkflowServiceHost> walks the activity tree and creates the service description.</span></span> <span data-ttu-id="0ab34-139">구성이 호스트에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-139">Configuration is applied to the host.</span></span> <span data-ttu-id="0ab34-140">마지막으로 호스트가 들어오는 메시지를 수신 대기하기 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-140">Finally the host begins to listen for incoming messages.</span></span>  
  
 <span data-ttu-id="0ab34-141">다음 그림에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 CanCreateInstance가 `true`로 설정된 Receive 작업에 바인딩된 메시지를 받을 때 수행하는 작업을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-141">The following illustration shows what the <xref:System.ServiceModel.WorkflowServiceHost> does when it receives a message bound for a Receive activity that has CanCreateInstance set to `true`.</span></span>  
  
 <span data-ttu-id="0ab34-142">![워크플로 서비스 호스트에 메시지 수신](../../../../docs/framework/wcf/feature-details/media/wfhreceivemessagecci.gif "WFHReceiveMessageCCI")</span><span class="sxs-lookup"><span data-stu-id="0ab34-142">![Workflow Service Host Receives a message](../../../../docs/framework/wcf/feature-details/media/wfhreceivemessagecci.gif "WFHReceiveMessageCCI")</span></span>  
  
 <span data-ttu-id="0ab34-143">메시지가 도착하고 WCF 채널 스택에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-143">The message arrives and is processed by the WCF channel stack.</span></span> <span data-ttu-id="0ab34-144">스로틀이 확인되고 상관 관계 쿼리가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-144">Throttles are checked and correlation queries are executed.</span></span> <span data-ttu-id="0ab34-145">메시지가 기존 인스턴스에 바인딩된 경우 메시지가 배달됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-145">If the message is bound for an existing instance the message is delivered.</span></span> <span data-ttu-id="0ab34-146">새 인스턴스를 만들어야 하는 경우에는 Receive 활동의 CanCreateInstance 속성이 확인됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-146">If a new instance needs to be created, the Receive activity’s CanCreateInstance property is checked.</span></span> <span data-ttu-id="0ab34-147">이 속성이 true로 설정되었으면 새 인스턴스가 만들어지고 메시지가 배달됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-147">If it is set to true, a new instance is created and the message is delivered.</span></span>  
  
 <span data-ttu-id="0ab34-148">다음 그림에서는 <xref:System.ServiceModel.WorkflowServiceHost>에서 CanCreateInstance가 false로 설정된 Receive 작업에 바인딩된 메시지를 받을 때 수행하는 작업을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-148">The following illustration shows what the <xref:System.ServiceModel.WorkflowServiceHost> does when it receives a message bound for a Receive activity that has CanCreateInstance set to false.</span></span>  
  
 <span data-ttu-id="0ab34-149">![WorkflowServiceHost에 메시지 수신](../../../../docs/framework/wcf/feature-details/media/wfshreceivemessage.gif "WFSHReceiveMessage")</span><span class="sxs-lookup"><span data-stu-id="0ab34-149">![WorkflowServiceHost receives a message](../../../../docs/framework/wcf/feature-details/media/wfshreceivemessage.gif "WFSHReceiveMessage")</span></span>  
  
 <span data-ttu-id="0ab34-150">메시지가 도착하고 WCF 채널 스택에서 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-150">The message arrives and is processed by the WCF channel stack.</span></span> <span data-ttu-id="0ab34-151">스로틀이 확인되고 상관 관계 쿼리가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-151">Throttles are checked and correlation queries are executed.</span></span> <span data-ttu-id="0ab34-152">메시지가 기존 인스턴스에 바인딩되어 있으므로(CanCreateInstance가 false이기 때문) 인스턴스가 지속성 저장소에서 로드되고 책갈피가 다시 시작되며 워크플로가 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-152">The message is bound for an existing instance (because CanCreateInstance is false) so the instance is loaded from persistence store, the bookmark is resumed and the workflow executes.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="0ab34-153">SQL Server가 NamedPipe 프로토콜에서만 수신하도록 구성되어 있으면 워크플로 서비스 호스트가 열리지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="0ab34-153">Workflow Service Host will fail to open if SQL Server is configured to listen on NamedPipe protocol only.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0ab34-154">참고 항목</span><span class="sxs-lookup"><span data-stu-id="0ab34-154">See Also</span></span>  
 [<span data-ttu-id="0ab34-155">워크플로 서비스</span><span class="sxs-lookup"><span data-stu-id="0ab34-155">Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/workflow-services.md)  
 [<span data-ttu-id="0ab34-156">워크플로 서비스 호스팅</span><span class="sxs-lookup"><span data-stu-id="0ab34-156">Hosting Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/hosting-workflow-services.md)  
 [<span data-ttu-id="0ab34-157">워크플로 제어 끝점</span><span class="sxs-lookup"><span data-stu-id="0ab34-157">Workflow Control Endpoint</span></span>](../../../../docs/framework/wcf/feature-details/workflow-control-endpoint.md)  
 [<span data-ttu-id="0ab34-158">워크플로 관리 끝점 샘플</span><span class="sxs-lookup"><span data-stu-id="0ab34-158">Workflow Management Endpoint Sample</span></span>](../../../../docs/framework/windows-workflow-foundation/samples/workflow-management-endpoint-sample.md)  
 [<span data-ttu-id="0ab34-159">방법: 워크플로 구성 WorkflowServiceHost로 예외 동작을 처리 하지 않음</span><span class="sxs-lookup"><span data-stu-id="0ab34-159">How to: Configure Workflow Unhandled Exception Behavior with WorkflowServiceHost</span></span>](../../../../docs/framework/wcf/feature-details/config-workflow-unhandled-exception-workflowservicehost.md)  
 [<span data-ttu-id="0ab34-160">장기 실행 워크플로 서비스 만들기</span><span class="sxs-lookup"><span data-stu-id="0ab34-160">Creating a Long-running Workflow Service</span></span>](../../../../docs/framework/wcf/feature-details/creating-a-long-running-workflow-service.md)  
 [<span data-ttu-id="0ab34-161">워크플로 유지</span><span class="sxs-lookup"><span data-stu-id="0ab34-161">Workflow Persistence</span></span>](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)
