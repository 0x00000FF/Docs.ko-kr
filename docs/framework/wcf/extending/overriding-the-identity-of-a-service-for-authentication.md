---
title: 인증을 위해 서비스 ID 재정의
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: d613a22b-07d7-41a4-bada-1adc653b9b5d
ms.openlocfilehash: 5649ef4cc05c9c16b1f8f626ba5e2e584b0e52eb
ms.sourcegitcommit: 7980a91f90ae5eca859db7e6bfa03e23e76a1a50
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81278914"
---
# <a name="override-the-identity-of-a-service-for-authentication"></a><span data-ttu-id="9a830-102">인증을 위해 서비스의 ID를 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-102">Override the identity of a service for authentication</span></span>

<span data-ttu-id="9a830-103">일반적으로 선택한 클라이언트 자격 증명 형식에 따라 서비스 메타데이터에 노출되는 ID 형식이 결정되므로 서비스에 ID를 설정할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-103">Typically, you do not have to set the identity on a service because the selection of a client credential type dictates the type of identity exposed in the service metadata.</span></span> <span data-ttu-id="9a830-104">예를 들어 다음 구성 코드는 [ \<wsHttpBinding>](../../configure-apps/file-schema/wcf/wshttpbinding.md) `clientCredentialType` 요소를 사용하고 특성을 Windows에 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-104">For example, the following configuration code uses the [\<wsHttpBinding>](../../configure-apps/file-schema/wcf/wshttpbinding.md) element and sets the `clientCredentialType` attribute to Windows.</span></span>  

 <span data-ttu-id="9a830-105">다음 WSDL(웹 서비스 기술 언어) 단편에서는 이전에 정의한 엔드포인트의 ID를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-105">The following Web Services Description Language (WSDL) fragment shows the identity for the endpoint previously defined.</span></span> <span data-ttu-id="9a830-106">이 예제에서는 서비스가 특정 사용자 계정()username@contoso.com에서 자체 호스팅 서비스로 실행되므로 UPN(사용자 주체 이름) ID에는 계정 이름이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-106">In this example, the service is running as a self-hosted service under a particular user account (username@contoso.com) and therefore the user principal name (UPN) identity contains the account name.</span></span> <span data-ttu-id="9a830-107">UPN은 Windows 도메인의 사용자 로그인 이름이라고도 합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-107">The UPN is also known as the user sign-in name in a Windows domain.</span></span>  

 <span data-ttu-id="9a830-108">ID 설정을 보여 주는 샘플 응용 프로그램에 대 한 [서비스 ID 샘플](../samples/service-identity-sample.md)을 참조 합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-108">For a sample application that demonstrates identity setting, see [Service Identity Sample](../samples/service-identity-sample.md).</span></span> <span data-ttu-id="9a830-109">서비스 ID에 대한 자세한 내용은 [서비스 ID 및 인증을](../feature-details/service-identity-and-authentication.md)참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="9a830-109">For more information about service identity, see [Service Identity and Authentication](../feature-details/service-identity-and-authentication.md).</span></span>  
  
## <a name="kerberos-authentication-and-identity"></a><span data-ttu-id="9a830-110">Kerberos 인증 및 ID</span><span class="sxs-lookup"><span data-stu-id="9a830-110">Kerberos Authentication and Identity</span></span>  
 <span data-ttu-id="9a830-111">기본적으로 서비스가 Windows 자격 증명을 사용하도록 구성된 경우 [ \<사용자PrincipalName>](../../configure-apps/file-schema/wcf/userprincipalname.md) 또는 [ \<servicePrincipalName>](../../configure-apps/file-schema/wcf/serviceprincipalname.md) 요소를 포함하는 [ \<ID>](../../configure-apps/file-schema/wcf/identity.md) 요소가 WSDL에서 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-111">By default, when a service is configured to use a Windows credential, an [\<identity>](../../configure-apps/file-schema/wcf/identity.md) element that contains a [\<userPrincipalName>](../../configure-apps/file-schema/wcf/userprincipalname.md) or [\<servicePrincipalName>](../../configure-apps/file-schema/wcf/serviceprincipalname.md) element is generated in the WSDL.</span></span> <span data-ttu-id="9a830-112">서비스가 `LocalSystem`에서 `LocalService` `NetworkService` 실행 중인 경우 SPN(서비스 주체 이름)은 기본적으로 호스트 `host/` \< *이름*> 형태로 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-112">If the service is running under the `LocalSystem`, `LocalService`, or `NetworkService` account, a service principal name (SPN) is generated by default in the form of `host/`\<*hostname*> because those accounts have access to the computer's SPN data.</span></span> <span data-ttu-id="9a830-113">서비스가 다른 계정에서 실행 중인 경우 WCF(Windows 통신 재단)는 \< *사용자 이름*>@<*도메인 이름*`>`의 형태로 UPN을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-113">If the service is running under a different account, Windows Communication Foundation (WCF) generates a UPN in the form of \<*username*>@<*domainName*`>`.</span></span> <span data-ttu-id="9a830-114">Kerberos 인증에서 서비스를 인증하려면 UPN 또는 SPN을 클라이언트에 제공해야 하므로 이 작업이 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-114">This occurs because Kerberos authentication requires that a UPN or SPN be supplied to the client to authenticate the service.</span></span>  
  
 <span data-ttu-id="9a830-115">[Setpn](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731241(v=ws.10)?redirectedfrom=MSDN) 도구를 사용하여 도메인에 있는 서비스 계정에 추가 SPN을 등록할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-115">You can also use the [Setspn](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731241(v=ws.10)?redirectedfrom=MSDN) tool to register an additional SPN with a service's account in a domain.</span></span> <span data-ttu-id="9a830-116">그런 다음 SPN을 서비스 ID로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-116">You can then use the SPN as the identity of the service.</span></span> <span data-ttu-id="9a830-117">도구에 대한 자세한 내용은 [Setpn 개요를](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc773257(v=ws.10))참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="9a830-117">For more information about the tool, see [Setspn Overview](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc773257(v=ws.10)).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="9a830-118">Windows 자격 증명 형식을 협상 없이 사용하려면 서비스의 사용자 계정이 Active Directory 도메인에 등록된 SPN에 대한 액세스 권한이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-118">To use the Windows credential type without negotiation, the service's user account must have access to the SPN that is registered with the Active Directory domain.</span></span> <span data-ttu-id="9a830-119">다음과 같은 방법으로 이 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-119">You can do this in the following ways:</span></span>  
  
- <span data-ttu-id="9a830-120">NetworkService 또는 LocalSystem 계정을 사용하여 서비스를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-120">Use the NetworkService or LocalSystem account to run your service.</span></span> <span data-ttu-id="9a830-121">이러한 계정은 컴퓨터가 Active Directory 도메인에 가입할 때 설정된 컴퓨터 SPN에 액세스할 수 있으므로 WCF는 서비스의 메타데이터(WSDL)에서 서비스의 끝점 내에 적절한 SPN 요소를 자동으로 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-121">Because those accounts have access to the machine SPN that is established when the machine joins the Active Directory domain, WCF automatically generates the proper SPN element inside the service's endpoint in the service's metadata (WSDL).</span></span>  
  
- <span data-ttu-id="9a830-122">임의의 Active Directory 도메인 계정을 사용하여 서비스를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-122">Use an arbitrary Active Directory domain account to run your service.</span></span> <span data-ttu-id="9a830-123">이 경우 해당 도메인 계정의 SPN을 설정합니다. Setspn.exe 유틸리티 도구를 사용하여 이 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-123">In this case, establish an SPN for that domain account, which you can do by using the Setspn.exe utility tool.</span></span> <span data-ttu-id="9a830-124">서비스 계정에 대한 SPN을 만든 후 WCF를 구성하여 해당 SPN을 WSDL(메타데이터)을 통해 서비스의 클라이언트에 게시하도록 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-124">Once you create the SPN for the service's account, configure WCF to publish that SPN to the service's clients through its metadata (WSDL).</span></span> <span data-ttu-id="9a830-125">이 작업은 애플리케이션 구성 파일이나 코드를 통해 노출된 엔드포인트에 대한 엔드포인트 ID를 설정하여 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-125">This is done by setting the endpoint identity for the exposed endpoint, either through an application configuration file or code.</span></span>  
  
 <span data-ttu-id="9a830-126">SPN, Kerberos 프로토콜 및 Active Directory에 대한 자세한 내용은 [Windows용 Kerberos 기술 보충을](https://docs.microsoft.com/previous-versions/msp-n-p/ff649429(v=pandp.10))참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="9a830-126">For more information about SPNs, the Kerberos protocol, and Active Directory, see [Kerberos Technical Supplement for Windows](https://docs.microsoft.com/previous-versions/msp-n-p/ff649429(v=pandp.10)).</span></span>  
  
### <a name="when-spn-or-upn-equals-the-empty-string"></a><span data-ttu-id="9a830-127">SPN 또는 UPN이 빈 문자열인 경우</span><span class="sxs-lookup"><span data-stu-id="9a830-127">When SPN or UPN Equals the Empty String</span></span>  
 <span data-ttu-id="9a830-128">SPN 또는 UPN을 빈 문자열과 같게 설정하면 사용되는 보안 수준과 인증 모드에 따라 다른 많은 작업이 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-128">If you set the SPN or UPN equal to an empty string, a number of different things happen, depending on the security level and authentication mode being used:</span></span>  
  
- <span data-ttu-id="9a830-129">전송 수준 보안을 사용하는 경우 NTLM(NT LanMan) 인증이 선택됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-129">If you are using transport level security, NT LanMan (NTLM) authentication is chosen.</span></span>  
  
- <span data-ttu-id="9a830-130">메시지 수준 보안을 사용하는 경우 인증 모드에 따라 인증이 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-130">If you are using message level security, authentication may fail, depending on the authentication mode:</span></span>  
  
- <span data-ttu-id="9a830-131">모드를 사용하고 `spnego` 있고 특성이 `AllowNtlm` `false`'로 설정된 경우 인증실패합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-131">If you are using `spnego` mode and the `AllowNtlm` attribute is set to `false`, authentication fails.</span></span>  
  
- <span data-ttu-id="9a830-132">모드를 사용하고 `spnego` 있고 특성이 `AllowNtlm` `true`으로 설정된 경우 UPN이 비어 있지만 SPN이 비어 있으면 인증이 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-132">If you are using `spnego` mode and the `AllowNtlm` attribute is set to `true`, authentication fails if the UPN is empty but succeeds if the SPN is empty.</span></span>  
  
- <span data-ttu-id="9a830-133">"단일 쇼트"라고도 하는 Kerberos direct를 사용하는 경우 인증이 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-133">If you are using Kerberos direct (also known as "one-shot"), authentication fails.</span></span>  
  
### <a name="use-the-identity-element-in-configuration"></a><span data-ttu-id="9a830-134">구성에서 \<요소의 id> 사용</span><span class="sxs-lookup"><span data-stu-id="9a830-134">Use the \<identity> Element in Configuration</span></span>  
 <span data-ttu-id="9a830-135">이전에 표시된 `Certificate`바인딩에서 클라이언트 자격 증명 유형을 변경하는 경우 생성된 WSDL에는 다음 코드에 표시된 ID 값에 대한 Base64 직렬화된 X.509 인증서가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-135">If you change the client credential type in the binding previously shown to `Certificate`, then the generated WSDL contains a Base64 serialized X.509 certificate for the identity value as shown in the following code.</span></span> <span data-ttu-id="9a830-136">이는 Windows 이외의 모든 클라이언트 자격 증명 형식에 대한 기본값입니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-136">This is the default for all client credential types other than Windows.</span></span>  

 <span data-ttu-id="9a830-137">구성에서 <`identity`> 요소를 사용하거나 코드에서 ID를 설정하여 기본 서비스 ID의 값을 변경하거나 ID 유형을 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-137">You can change the value of the default service identity or change the type of the identity by using the <`identity`> element in configuration or by setting the identity in code.</span></span> <span data-ttu-id="9a830-138">다음 구성 코드에서는 값 `contoso.com`으로 DNS(Domain Name System) ID를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-138">The following configuration code sets a domain name system (DNS) identity with the value `contoso.com`.</span></span>  

### <a name="set-identity-programmatically"></a><span data-ttu-id="9a830-139">프로그래밍 방식으로 ID 설정</span><span class="sxs-lookup"><span data-stu-id="9a830-139">Set Identity Programmatically</span></span>  
 <span data-ttu-id="9a830-140">WCF가 자동으로 ID를 결정하기 때문에 서비스는 ID를 명시적으로 지정할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-140">Your service does not have to explicitly specify an identity, because WCF automatically determines it.</span></span> <span data-ttu-id="9a830-141">그러나 WCF를 사용하면 필요한 경우 끝점에 ID를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-141">However, WCF allows you to specify an identity on an endpoint, if necessary.</span></span> <span data-ttu-id="9a830-142">다음 코드에서는 특정 DNS ID를 사용하여 새 서비스 엔드포인트를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="9a830-142">The following code adds a new service endpoint with a specific DNS identity.</span></span>  
  
 [!code-csharp[C_Identity#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#5)]
 [!code-vb[C_Identity#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#5)]  
  
## <a name="see-also"></a><span data-ttu-id="9a830-143">참고 항목</span><span class="sxs-lookup"><span data-stu-id="9a830-143">See also</span></span>

- [<span data-ttu-id="9a830-144">방법: 사용자 지정 클라이언트 ID 검증 도구 만들기</span><span class="sxs-lookup"><span data-stu-id="9a830-144">How to: Create a Custom Client Identity Verifier</span></span>](how-to-create-a-custom-client-identity-verifier.md)
- [<span data-ttu-id="9a830-145">서비스 ID 및 인증</span><span class="sxs-lookup"><span data-stu-id="9a830-145">Service Identity and Authentication</span></span>](../feature-details/service-identity-and-authentication.md)
